{"version":3,"sources":["components/MyAvatar/MyAvatar.js","defines/Slt.js","defines/Config.js","defines/https/UserApi.js","defines/Helper.js","defines/MyTime.js","defines/Socket.js","defines/Socket/SocketEventName.js","defines/Socket/MySocket.js","features/auth/authSlice.js","GeneralSlices/themeSlice.js","components/DayNightSwitch/DayNightSwitch.js","components/IconWithBadge.js","components/RouterLink/RouterLink.js","components/Notifications/Notifications.js","defines/CookieName.js","components/Sidebar/Sidebar.js","components/Header/Header.js","defines/styles/MainStyles.js","components/MyAvatarGroup/MyAvatarGroup.js","defines/https/ConversationApi.js","features/chat/ChatSlice.js","components/ConversationLink/ConversationLink.js","components/ConversationItem/ConversationItem.js","features/sidebarConversations/SidebarConversationsSlice.js","components/ConversationList/ConversationList.js","features/NewChat/NewChatSlice.js","components/Loading/Loading.js","components/Message/Message.js","components/ChatNotification/ChatNotification.js","components/Messages/Messages.js","components/SendingInput/SendingInput.js","features/notify/NotifySlice.js","defines/Message.js","components/SendMessageBar/SendMessageBar.js","components/UserTyping/UserTyping.js","components/NormalChat/NormalChat.js","components/Receiver/Receiver.js","components/SuggestionUsers/SuggestionUsers.js","components/NewChat/NewChat.js","components/ChatBox/ChatBox.js","components/AppTitle/AppTitle.js","features/OnlineUser/OnlineUserSlice.js","components/OnlineUser/OnlineUsers.js","features/chat/Chat.js","defines/configs/FormErrors.js","components/SignIn/SignIn.js","defines/validates/UserValidates.js","components/SignUp/SignUp.js","features/notify/Notify.js","components/PrivateRoute/PrivateRoute.js","features/friend/FriendSlice.js","components/FriendAction/SentRequestAction.js","components/FriendAction/RequestAction.js","components/FriendAction/StrangerAction.js","components/FriendAction/FriendAction.js","components/FriendList/FriendList.js","components/FriendBox/FriendBox.js","components/Friends/Friends.js","components/AuthRoute/AuthRoute.js","App.js","components/store.js","index.js"],"names":["StyledBadge","withStyles","theme","badge","backgroundColor","color","boxShadow","palette","background","paper","transform","opacity","Badge","useStyles","makeStyles","root","display","margin","spacing","MyAvatar","name","picture","online","sizeInPixel","classes","myStyle","width","height","avatar","Avatar","style","alt","src","className","overlap","anchorOrigin","vertical","horizontal","variant","Slt","mainAppBar","API_ADDRESS","prefix","UserApi","findByUsername","username","a","Axios","get","params","data","findByUsernameAndPassword","password","post","createAccount","findAllFriendsByUsername","findSentRequestFriendById","id","findStrangerByUsername","sentFriendRequest","friendId","unfriend","cancelFriendRequest","deleteFriendRequest","confirmFriendRequest","findUsersByIds","ids","findReceivers","exceptIds","findFriends","type","userId","Helper","ucFirst","str","slice","toUpperCase","titleCase","words","trim","split","length","reduce","accumulator","this","sleep","ms","Promise","resolve","setTimeout","isFn","fn","format","string","result","key","replace","getArrayOfFieldValue","items","field","map","item","toString","arrayDiff","arr1","arr2","biggerArr","smallerArr","forEach","indexOf","push","MyTime","getUTCNow","now","Date","time","getTime","offset","getTimezoneOffset","getCurrentTimeByUTCTime","utcTime","getMessageTimeString","itemDate","getFullYear","getMonth","getDate","dateformat","Socket","io","SocketEventName","updateUser","signIn","signOut","getOnlineUsers","typing","stopTyping","sendMessage","receiveMessage","newMessageNotification","onlineUsers","newOnlineUser","onlineUserLeft","joinUsersToConversation","joinRoom","leaveRoom","acceptFriend","addFriend","friendRequestCanceled","friendRejected","friendAccepted","friendRequested","friendUnfriend","MySocket","emitSignIn","user","emit","emitSignOut","emitGetOnlineUsers","emitUpdateUserById","emitSendMessage","message","conversationId","emitTyping","emitStopTyping","emitJoinUsersToConversation","emitJoinRoom","roomName","emitLeaveRoom","emitAddFriend","emitAcceptFriend","emitUnfriend","emitCancelFriendRequest","emitDeleteFriendRequest","onNewOnlineUser","callback","on","onOnlineUserLeft","onUpdateUser","onReceiveMessage","onOnlineUsers","onTyping","onStopTyping","onNewMessageNotification","onFriendAccepted","onFriendRequested","onFriendUnFriend","onFriendRequestCanceled","onFriendRejected","off","eventName","loginThunk","createAsyncThunk","response","sentFriendRequestThunk","loginWithUser","state","action","payload","isLogged","authSlice","createSlice","initialState","status","error","reducers","login","extraReducers","pending","fulfilled","rejected","authError","auth","authUser","authUserId","_id","actions","themeSLice","switchThemeType","DayNightSwitch","useSelector","dispatch","useDispatch","useCookies","cookies","setCookie","useEffect","IconButton","aria-label","onClick","cookieValue","JSON","stringify","right","top","border","padding","RouterLink","children","rest","all","Notifications","useHistory","Fragment","to","Tooltip","title","LOGGED_USER","list","fullList","Sidebar","icon","React","useState","left","bottom","setState","toggleDrawer","anchor","open","event","Drawer","onClose","clsx","role","onKeyDown","List","ListItem","button","ListItemIcon","ListItemText","primary","Header","props","removeCookie","logged","authStatus","pathName","useLocation","pathname","history","toolsHtml","Box","alignItems","justifyContent","flexGrow","Hidden","smDown","mr","single","Button","disabled","startIcon","Typography","AppBar","position","Toolbar","mdUp","textDecoration","colors","mainStyles","createStyles","table","minWidth","chatSection","overflow","headBG","borderRight500","borderRight","borderLeft500","borderLeft","messageArea","overflowY","RoundLightGrayInputStyle","paddingLeft","paddingRight","borderRadius","buttonStyle","textTransform","flexCenterVerticalStyle","flexCenterStyle","defaultContainerPaddingStyle","MyAvatarGroup","max","avatars","index","AvatarGroup","ConversationApi","findConversationById","findConversationByMemberIds","findSidebarConversationById","listConversationsForListDisplay","findConversationInfoByUserIdsOrCreateIfNotExist","getHomeConversation","createConversationWithMemberIds","messageParams","fetchConversationByMemberIds","fetchConversationById","ChatSlice","findConversationByUserIdsOrCreateIfNotExist","conversation","sidebarConversations","appendMessage","messages","reset","conversationStatus","chat","conversationMemberIds","members","conversationMessages","ConversationLink","convoMemberIds","onItemClick","showConversation","isNew","useStyle","truncateListItemStyle","textOverflow","whiteSpace","GenerateAvatarGroup","ConversationItem","convoId","friends","filter","lastMessageText","lastMessage","from","text","currentVal","selected","ListItemAvatar","xsDown","secondary","fetchConversations","fetchAndPrependConversationById","conversationsAdapter","createEntityAdapter","selectId","sortComparer","b","getInitialState","SidebarConversationsSlice","updateLastMessage","entities","upsertOne","upsertMany","getSelectors","selectAllSidebarConversations","selectAll","selectSidebarConversationIds","selectById","selectIds","ConversationList","conversations","loggedUser","myFunc","removeListener","conversationsHtml","i","enabled","receivers","NewChatSlice","setEnabled","removeReceiverById","appendReceiver","removeLastReceiver","newChatReceivers","newChat","isNewChatEnable","newChatReceiver","removeNewChatReceiverById","appendNewChatReceiver","removeLastNewChatReceiver","setNewChatEnabled","resetNewChat","Loading","align","Message","notShowAvatar","ownMessage","flexPos","placement","ChatNotification","content","usernameHtml","component","emptyHtml","mt","Messages","newChatEnabled","messagesHtml","nextItem","containers","document","getElementsByClassName","scrollTop","scrollHeight","scroll","myTimeoutObj","NotifySlice","timeout","setNotify","notify","invalid","fail","welcomeNewAccount","PleaseTypeMessage","PleaseChooseReceiver","newMessage","unfriended","SendingInput","inputMsg","setInputMsg","isTyping","setTyping","convo","onSendingMessage","onCreateConversationsWithReceicersAndFristMessage","receiverIds","concat","onSubmit","e","preventDefault","onSendingMessageClick","Grid","container","xs","md","TextField","autoFocus","inputProps","autoComplete","value","fullWidth","onChange","target","onKeyUp","which","clearTimeout","onBlur","Send","SendMessageBar","Paper","UserTyping","typingUsers","setTypingUsers","typingHtml","process","elevation","NormalChat","loggedUserId","useParams","receiver","messageObj","SuggestionUsers","dense","generateSuggestionUsers","SelectedUsers","onCloseClick","Alert","severity","size","fontSize","Receiver","onFriendIdSelected","mounted","setMounted","suggestionUsers","setSuggestionUsers","inputVal","setInputVal","receiverName","setReceiverName","inputRef","useRef","fetchUsers","solveSelectedUsers","oldVal","newVal","placeholder","ref","current","querySelector","focus","NewChat","setFriendId","zIndex","ChatBox","loaded","setDisplay","convoStatus","mainHtml","AppTitle","adapter","OnlineUserSlice","addAll","addMany","removeOne","addOne","onlineUser","selectAllOnlineUser","addAllOnlineUser","addOneOnlineUser","removeOneOnlineUser","OnlineUsers","onlineUsersHtml","p","Chat","appBarHeight","FormErrors","required","lengthGreater","noSpecialCharacter","unique","match","marginTop","flexDirection","main","form","submit","SignIn","isSubmitClicked","setSubmitClicked","authErr","Container","maxWidth","CssBaseline","initialValues","passwordConfirmation","validationSchema","yup","values","setSubmitting","errors","touched","handleChange","handleBlur","handleSubmit","isSubmitting","isValid","dirty","showErrors","label","helperText","noValidate","cursor","isUsernameExist","isLengthValid","noSpecialCharacters","test","UserValidates","setUsername","timeoutObj","context","reject","isExist","matches","oneOf","SignUp","Notify","isOpen","msg","msgType","duration","handleClose","reason","Snackbar","autoHideDuration","PrivateRoute","render","location","fetchFriendsByIds","fetchStrangersByUsername","itemsInitialState","friend","request","sent_request","stranger","FriendSlice","onAddFriend","onUnFriend","onCancelFriendRequest","onRejectFriendRequest","onAcceptFriendRequest","onFriendUnfriend","onFriendCanceled","meta","arg","currentState","friendStatus","selectAllFriend","selectAllRequest","selectAllSentRequest","selectAllStranger","SentRequestAction","onCancelClick","onConfirmClick","onDeleteClick","onAddFriendClick","anchorEl","setAnchorEl","Boolean","onUnfriendClick","aria-controls","aria-haspopup","currentTarget","keepMounted","PaperProps","maxHeight","ITEM_HEIGHT","MenuItem","FriendList","isLoading","itemsHtml","localType","getType","CardActions","lg","Card","CardHeader","subheader","AllFriendList","SentRequestList","RequestList","PeopleMayKnowList","FriendBox","paddingTop","a11yProps","friendTabs","Friends","getElementsByTagName","body","setValue","tab","friendsTab","Tabs","newValue","indicatorColor","scrollButtons","Tab","AuthRoute","App","themeType","createMuiTheme","ThemeProvider","base","path","exact","configureStore","reducer","themeSlice","ReactDOM","store","getElementById"],"mappings":"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","file":"static/js/main.9f10bc1a.chunk.js","sourcesContent":["import React from 'react';\r\nimport Badge from '@material-ui/core/Badge';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport { makeStyles, withStyles } from '@material-ui/core/styles';\r\n\r\nconst StyledBadge = withStyles((theme) => ({\r\n    badge: {\r\n        backgroundColor: '#44b700',\r\n        color: '#44b700',\r\n        boxShadow: `0 0 0 2px ${theme.palette.background.paper}`,\r\n    },\r\n    '@keyframes ripple': {\r\n        '0%': {\r\n            transform: 'scale(.8)',\r\n            opacity: 1\r\n        },\r\n        '100%': {\r\n            transform: 'scale(2.4)',\r\n            opacity: 0\r\n        }\r\n    }\r\n}))(Badge);\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    root: {\r\n        display: 'flex',\r\n        '& > *': {\r\n            margin: theme.spacing(1)\r\n        }\r\n    }\r\n}));\r\n\r\nexport default function MyAvatar({ name, picture, online, sizeInPixel }) {\r\n    const classes = useStyles();\r\n    const myStyle = true ? { width: `${sizeInPixel}px`, height: `${sizeInPixel}px` } : {};\r\n    const avatar = <Avatar style={myStyle} alt={name} src={picture} />;\r\n    return (\r\n        <div className={classes.root}>\r\n            {(online) ? (\r\n                <StyledBadge\r\n                    overlap=\"circle\"\r\n                    anchorOrigin={{\r\n                        vertical: 'bottom',\r\n                        horizontal: 'right'\r\n                    }}\r\n                    variant=\"dot\">\r\n                    {avatar}\r\n                </StyledBadge>\r\n            ) : avatar\r\n            }\r\n        </div>\r\n    );\r\n}","const Slt = {\r\n    mainAppBar: '#main-app-bar'\r\n}\r\nexport default Slt;","export const isDevMode = false;\r\nexport const API_ADDRESS = isDevMode ? 'http://localhost:3000' : 'https://pa-chat.glitch.me';","import Axios from \"axios\";\r\nimport { API_ADDRESS } from \"../Config\";\r\n\r\nconst prefix = `${API_ADDRESS}/user`;\r\n\r\nconst UserApi = {\r\n    findByUsername: async function (username) {\r\n        const data = await Axios.get(`${prefix}/getUserByUsername`, {\r\n            params: {\r\n                username\r\n            }\r\n        })\r\n        return data.data;\r\n    },\r\n    findByUsernameAndPassword: async function (username, password) {\r\n        const data = await Axios.post(`${prefix}/getUserByUsernameAndPassword`, { username, password })\r\n        return data.data;\r\n    },\r\n    createAccount: async function (username, password) {\r\n        const data = await Axios.post(`${prefix}/createAccount`, { username, password })\r\n        return data.data;\r\n    },\r\n    findAllFriendsByUsername: async function (username) {\r\n        const data = await Axios.get(`${prefix}/getFriendsByUsername`, {\r\n            params: {\r\n                username\r\n            }\r\n        })\r\n        return data.data;\r\n    },\r\n    findSentRequestFriendById: async function (id) {\r\n        const data = await Axios.get(`${prefix}/getSentRequestFriendById`, {\r\n            params: {\r\n                id\r\n            }\r\n        })\r\n        return data.data;\r\n    },\r\n    findStrangerByUsername: async function (username) {\r\n        const data = await Axios.get(`${prefix}/getStrangerByUsername`, {\r\n            params: {\r\n                username\r\n            }\r\n        })\r\n        return data.data;\r\n    },\r\n\r\n    // FRIEND\r\n    sentFriendRequest: async function (id, friendId) {\r\n        const data = await Axios.post(`${prefix}/sentFriendRequest`, { id, friendId });\r\n        return data.data;\r\n    },\r\n    unfriend: async function (id, friendId) {\r\n        const data = await Axios.post(`${prefix}/unfriend`, { id, friendId });\r\n        return data.data;\r\n    },\r\n    cancelFriendRequest: async function (id, friendId) {\r\n        const data = await Axios.post(`${prefix}/cancelFriendRequest`, { id, friendId });\r\n        return data.data;\r\n    },\r\n    deleteFriendRequest: async function (id, friendId) {\r\n        const data = await Axios.post(`${prefix}/deleteFriendRequest`, { id, friendId });\r\n        return data.data;\r\n    },\r\n    confirmFriendRequest: async function (id, friendId) {\r\n        const data = await Axios.post(`${prefix}/confirmFriendRequest`, { id, friendId });\r\n        return data.data;\r\n    },\r\n    findUsersByIds: async function (ids) {\r\n        const data = await Axios.post(`${prefix}/getUsersByIds`, { ids });\r\n        return data.data;\r\n    },\r\n    findReceivers: async function (username, exceptIds) {\r\n        const data = await Axios.post(`${prefix}/getReceivers`, {\r\n            username, exceptIds,\r\n        });\r\n        return data.data;\r\n    },\r\n    findFriends: async function (type, userId) {\r\n        return [];\r\n    },\r\n}\r\nexport default UserApi;","const Helper = {\r\n    ucFirst: function (str) {\r\n        if (str) {\r\n            return str.slice(0, 1).toUpperCase() + str.slice(1);\r\n        }\r\n    },\r\n    titleCase: function (str) {\r\n        if (str) {\r\n            let result;\r\n            str = str.trim();\r\n            let words = str.split(' ');\r\n            if (words.length > 1)\r\n                result = words.reduce((accumulator) => {\r\n                    return this.ucFirst(accumulator) + ' ';\r\n                })\r\n            else result = this.ucFirst(words[0]);\r\n            result = result.trim();\r\n            return result;\r\n        }\r\n    },\r\n    sleep: ms => new Promise(resolve => setTimeout(() => { resolve(); }, ms)),\r\n    isFn: fn => typeof fn === 'function',\r\n    format: function (string, ...params) {\r\n        let result = string;\r\n        if (string && params.length > 0) {\r\n            for (let key in params) {\r\n                result = result.replace(`{${key}}`, params[key]);\r\n            }\r\n        }\r\n        return result;\r\n    },\r\n    getArrayOfFieldValue: function (items, field, type) {\r\n        const arrayOfFieldValue = items.map((item) => {\r\n            if (type === 'string') return item[field].toString();\r\n            return item[field];\r\n        })\r\n        return arrayOfFieldValue;\r\n    },\r\n    arrayDiff: function (arr1, arr2) {\r\n        let biggerArr;\r\n        let smallerArr;\r\n        let result = [];\r\n        if (arr1.length > arr2.length) {\r\n            biggerArr = arr1;\r\n            smallerArr = arr2;\r\n        }\r\n        else {\r\n            biggerArr = arr2;\r\n            smallerArr = arr1;\r\n        }\r\n        biggerArr.forEach((item) => {\r\n            if (smallerArr.indexOf(item) === -1) result.push(item);\r\n        })\r\n        return result;\r\n    }\r\n}\r\n\r\nexport default Helper;","import * as dateformat from 'dateformat';\r\nconst MyTime = {\r\n\r\n    getUTCNow: function () {\r\n        var now = new Date();\r\n        var time = now.getTime();\r\n        var offset = now.getTimezoneOffset();\r\n        offset = offset * 60000;\r\n        return time - offset;\r\n    },\r\n\r\n    getCurrentTimeByUTCTime: function (utcTime) {\r\n        let now = new Date();\r\n        let offset = now.getTimezoneOffset();\r\n        offset = offset * 60000;\r\n        return utcTime + offset;\r\n    },\r\n\r\n    getMessageTimeString: function (time) {\r\n        let itemDate = new Date(time);\r\n        let now = new Date();\r\n        let result\r\n        if (\r\n            (\r\n                now.getFullYear() === itemDate.getFullYear() &&\r\n                now.getMonth() === itemDate.getMonth() &&\r\n                now.getDate() === itemDate.getDate()\r\n            )\r\n\r\n        )\r\n            result = dateformat(time, 'HH:MM');\r\n        else\r\n            result = dateformat(time, 'dd/mm/yyyy HH:MM');\r\n        return result;\r\n    },\r\n}\r\nexport default MyTime;","import { io } from \"socket.io-client\";\r\nimport { API_ADDRESS } from \"./Config\";\r\n\r\nvar connectionOptions = {\r\n    \"force new connection\": true,\r\n    \"reconnectionAttempts\": \"Infinity\",\r\n    \"timeout\": 10000,\r\n    \"transports\": [\"websocket\"]\r\n};\r\nconst Socket = io(API_ADDRESS, connectionOptions);\r\nexport default Socket;","const SocketEventName = {\r\n    updateUser: 'update-user',\r\n    signIn: 'sign-in',\r\n    signOut: 'sign-out',\r\n    getOnlineUsers: 'get-online-users',\r\n    typing: 'typing',\r\n    stopTyping: 'stop-typing',\r\n    sendMessage: 'send-message',\r\n    receiveMessage: 'receive-message',\r\n    newMessageNotification: 'new-message-notification',\r\n    onlineUsers: 'online-users',\r\n    newOnlineUser: 'new-online-user',\r\n    onlineUserLeft: 'online-user-left',\r\n    joinUsersToConversation: 'join-users-to-conversation',\r\n    joinRoom: 'join-room',\r\n    leaveRoom: 'leave-room',\r\n    acceptFriend: 'accept-friend',\r\n    addFriend: 'add-friend',\r\n    unfriend: 'unfriend',\r\n    cancelFriendRequest: 'cancel-friend-request',\r\n    deleteFriendRequest: 'delete-friend-request',\r\n    friendRequestCanceled: 'friend-request-canceled',\r\n    friendRejected: 'friend-rejected',\r\n    friendAccepted: 'friend-accepted',\r\n    friendRequested: 'friend-requested',\r\n    friendUnfriend: 'friend-unfriend',\r\n}\r\n\r\nexport default SocketEventName;","import Helper from '../Helper';\r\nimport MyTime from '../MyTime';\r\nimport Socket from '../Socket';\r\nimport SocketEventName from './SocketEventName';\r\nconst MySocket = {\r\n    // EMIT\r\n    emitSignIn: function (user) {\r\n        Socket.emit(SocketEventName.signIn, { user });\r\n    },\r\n    emitSignOut: function (user) {\r\n        Socket.emit(SocketEventName.signOut, { user });\r\n    },\r\n    emitGetOnlineUsers: function () {\r\n        Socket.emit(SocketEventName.getOnlineUsers);\r\n    },\r\n    emitUpdateUserById: function (id) {\r\n        Socket.emit(SocketEventName.updateUser, { id });\r\n    },\r\n    emitSendMessage: function (user, message, conversationId) {\r\n        Socket.emit(SocketEventName.sendMessage, { user, message, conversationId });\r\n    },\r\n    emitTyping: function (user, conversationId) {\r\n        Socket.emit(SocketEventName.typing, { user, conversationId });\r\n    },\r\n    emitStopTyping: function (username, conversationId) {\r\n        Socket.emit(SocketEventName.stopTyping, { username, conversationId });\r\n    },\r\n    emitJoinUsersToConversation: function (ids, conversationId) {\r\n        Socket.emit(SocketEventName.joinUsersToConversation, { ids, conversationId });\r\n    },\r\n    emitJoinRoom: function (roomName) {\r\n        Socket.emit(SocketEventName.joinRoom, { roomName });\r\n    },\r\n    emitLeaveRoom: function (roomName) {\r\n        Socket.emit(SocketEventName.leaveRoom, { roomName });\r\n    },\r\n\r\n    // FRIEND ACTION\r\n    emitAddFriend: function (user, friendId) {\r\n        Socket.emit(SocketEventName.addFriend, { user, friendId });\r\n    },\r\n    emitAcceptFriend: function (user, friendId) {\r\n        Socket.emit(SocketEventName.acceptFriend, { user, friendId });\r\n    },\r\n    emitUnfriend: function (user, friendId) {\r\n        Socket.emit(SocketEventName.unfriend, { user, friendId });\r\n    },\r\n    emitCancelFriendRequest: function (user, friendId) {\r\n        Socket.emit(SocketEventName.cancelFriendRequest, { user, friendId });\r\n    },\r\n    emitDeleteFriendRequest: function (user, friendId) {\r\n        Socket.emit(SocketEventName.deleteFriendRequest, { user, friendId });\r\n    },\r\n\r\n    // ON\r\n    onNewOnlineUser: function (callback) {\r\n        Socket.on(SocketEventName.newOnlineUser, callback);\r\n    },\r\n    onOnlineUserLeft: function (callback) {\r\n        Socket.on(SocketEventName.onlineUserLeft, callback);\r\n    },\r\n\r\n    onUpdateUser: function (callback) {\r\n        Socket.on(SocketEventName.updateUser, callback);\r\n    },\r\n    onReceiveMessage: function (callback) {\r\n        Socket.on(SocketEventName.receiveMessage, callback);\r\n    },\r\n    onOnlineUsers: function (callback) {\r\n        Socket.on(SocketEventName.onlineUsers, callback);\r\n    },\r\n    onTyping: function (callback) {\r\n        Socket.on(SocketEventName.typing, callback);\r\n    },\r\n    onStopTyping: function (callback) {\r\n        Socket.on(SocketEventName.stopTyping, callback)\r\n    },\r\n\r\n    // NOTIFICATION\r\n    onNewMessageNotification: function (callback) {\r\n        Socket.on(SocketEventName.newMessageNotification, callback)\r\n    },\r\n\r\n    // FRIEND ACTIONS\r\n    onFriendAccepted: function (callback) {\r\n        Socket.on(SocketEventName.friendAccepted, callback)\r\n    },\r\n    onFriendRequested: function (callback) {\r\n        Socket.on(SocketEventName.friendRequested, callback)\r\n    },\r\n    onFriendUnFriend: function (callback) {\r\n        Socket.on(SocketEventName.friendUnfriend, callback)\r\n    },\r\n    onFriendRequestCanceled: function (callback) {\r\n        Socket.on(SocketEventName.friendRequestCanceled, callback)\r\n    },\r\n    onFriendRejected: function (callback) {\r\n        Socket.on(SocketEventName.friendRejected, callback)\r\n    },\r\n    off: function (eventName) {\r\n        Socket.off(eventName);\r\n    },\r\n}\r\nexport default MySocket","import { createAsyncThunk, createSlice } from '@reduxjs/toolkit'\r\nimport UserApi from '../../defines/https/UserApi';\r\nimport MySocket from '../../defines/Socket/MySocket';\r\n\r\nexport const loginThunk = createAsyncThunk('auth/login', async ({ username, password, }) => {\r\n    const response = await UserApi.findByUsernameAndPassword(username, password);\r\n    return response;\r\n})\r\n\r\nexport const sentFriendRequestThunk = createAsyncThunk('auth/sentFriendRequest', async ({ id, friendId, }) => {\r\n    const response = await UserApi.sentFriendRequest(id, friendId);\r\n    return response;\r\n})\r\n\r\nconst initialState = {\r\n    isLogged: false,\r\n    user: null,\r\n    status: 'idle',\r\n    error: null,\r\n}\r\n\r\nconst loginWithUser = (state, action) => {\r\n    MySocket.emitSignIn(action.payload);\r\n    state.user = action.payload;\r\n    state.isLogged = true;\r\n}\r\n\r\nconst authSlice = createSlice({\r\n    name: 'auth',\r\n    initialState,\r\n    reducers: {\r\n        login: (state, action) => {\r\n            loginWithUser(state, action)\r\n        },\r\n        updateUser: (state, action) => {\r\n            state.user = action.payload;\r\n        },\r\n        signOut: (state) => {\r\n            MySocket.emitSignOut(state.user);\r\n            state.user = null;\r\n            state.isLogged = false;\r\n        }\r\n    },\r\n    extraReducers: {\r\n        // LOGIN\r\n        [loginThunk.pending]: (state, action) => {\r\n            state.status = 'loading'\r\n        },\r\n        [loginThunk.fulfilled]: (state, action) => {\r\n            const { payload, status } = action.payload;\r\n\r\n            if (status === 'succeeded') {\r\n                loginWithUser(state, { payload });\r\n                state.error = null;\r\n            } else state.error = 'not found';\r\n            state.status = 'succeeded'\r\n        },\r\n        [loginThunk.rejected]: (state, action) => {\r\n            state.error = action.error.message\r\n            state.status = 'failed'\r\n        },\r\n\r\n        // FRIENDS\r\n        [sentFriendRequestThunk.fulfilled]: (state, action) => {\r\n        },\r\n\r\n    }\r\n});\r\n\r\nconst selectors = {\r\n    isLogged: (state) => {\r\n        return state.auth.isLogged;\r\n    },\r\n    authUser: (state) => {\r\n        return state.auth.user;\r\n    },\r\n    status: (state) => {\r\n        return state.auth.status;\r\n    },\r\n    authError: (state) => {\r\n        return state.auth.error;\r\n    },\r\n    authUserId: (state) =>{\r\n        return state.auth.user._id;\r\n    }\r\n}\r\n\r\nexport const { authError, status, isLogged, authUser,  authUserId} = selectors;\r\n\r\n\r\nexport const {\r\n    signOut, login, updateUser\r\n} = authSlice.actions\r\n\r\nexport default authSlice.reducer","import { createSlice } from '@reduxjs/toolkit'\r\n\r\nconst initialState = {\r\n    type: 'light',\r\n}\r\n\r\nconst themeSLice = createSlice({\r\n    name: 'theme',\r\n    initialState,\r\n    reducers: {\r\n        switchThemeType: (state) => {\r\n            state.type = (state.type === 'light') ? 'dark' : 'light';\r\n        }\r\n    }\r\n});\r\n\r\nexport const {\r\n    switchThemeType\r\n} = themeSLice.actions\r\nexport default themeSLice.reducer","import React, { useEffect } from 'react'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport DayIcon from '@material-ui/icons/Brightness7';\r\nimport NightIcon from '@material-ui/icons/Brightness4';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { switchThemeType } from '../../GeneralSlices/themeSlice';\r\nimport { useCookies } from 'react-cookie';\r\n\r\nexport default function DayNightSwitch() {\r\n    const theme = useSelector((state) => { return state.theme });\r\n    const dispatch = useDispatch();\r\n    const [cookies, setCookie, removeCookie] = useCookies(['theme'])\r\n\r\n    useEffect(() => {\r\n        if (cookies.theme) {\r\n            if (cookies.theme.type) {\r\n                if (cookies.theme.type !== theme.type) {\r\n                    dispatch(switchThemeType());\r\n                }\r\n            }\r\n        }\r\n    })\r\n\r\n    const onSwitch = () => {\r\n        let cookieValue = { ...theme, type: theme.type === 'light' ? 'dark' : 'light', };\r\n        setCookie('theme', JSON.stringify(cookieValue));\r\n        dispatch(switchThemeType());\r\n    }\r\n\r\n    return (\r\n        <IconButton aria-label=\"Day / night toggle\" onClick={onSwitch} color=\"inherit\">\r\n            {(theme.type === 'light') ? <NightIcon></NightIcon> : <DayIcon></DayIcon>}\r\n        </IconButton>\r\n    )\r\n}\r\n","import React from 'react';\r\nimport Badge from '@material-ui/core/Badge';\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport IconButton from '@material-ui/core/IconButton';\r\n\r\nconst StyledBadge = withStyles((theme) => ({\r\n    badge: {\r\n        right: -3,\r\n        top: 5,\r\n        border: '1px solid white',\r\n        padding: '0 4px',\r\n    },\r\n}))(Badge);\r\n\r\nexport default function IconWithBadge({ badgeContent, children, ...rest }) {\r\n    return (\r\n        <IconButton color=\"inherit\" {...rest}>\r\n            <StyledBadge badgeContent={badgeContent || ''} color=\"primary\">\r\n                {children}\r\n            </StyledBadge>\r\n        </IconButton>\r\n    );\r\n}\r\n","import React from 'react'\r\nimport { Link } from 'react-router-dom'\r\n\r\nexport default function RouterLink({ children, ...rest }) {\r\n    return (\r\n        <Link {...rest} style={{all: 'unset'}}>{children}</Link>\r\n    )\r\n}\r\n","import React from 'react'\r\n\r\nimport IconWithBadge from '../IconWithBadge';\r\nimport PeopleAltIcon from '@material-ui/icons/PeopleAlt';\r\nimport MessageIcon from '@material-ui/icons/Message';\r\nimport MailIcon from '@material-ui/icons/Mail';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { Hidden, IconButton, Tooltip } from '@material-ui/core';\r\nimport RouterLink from '../RouterLink/RouterLink';\r\n\r\nexport default function Notifications() {\r\n    const history = useHistory();\r\n\r\n    return (\r\n        <React.Fragment>\r\n            {/* \r\n            <IconWithBadge badgeContent=\"10\">\r\n                <MailIcon></MailIcon>\r\n            </IconWithBadge>\r\n             */}\r\n            {/* \r\n            <IconWithBadge badgeContent=\"10\" onClick={() => {\r\n                history.push('/friends');\r\n            }}>\r\n            </IconWithBadge>\r\n              */}\r\n            <RouterLink to=\"/chat/new\">\r\n                <Tooltip title=\"Chat\">\r\n                    <IconButton color=\"inherit\">\r\n                        <MessageIcon></MessageIcon>\r\n                    </IconButton>\r\n                </Tooltip>\r\n            </RouterLink>\r\n            <RouterLink to=\"/friends\">\r\n                <Tooltip title=\"Friends\">\r\n                    <IconButton color=\"inherit\">\r\n                        <PeopleAltIcon></PeopleAltIcon>\r\n                    </IconButton>\r\n                </Tooltip>\r\n            </RouterLink>\r\n        </React.Fragment>\r\n    )\r\n}\r\n","export const LOGGED_USER = 'loggedUser';","import React from 'react';\r\nimport clsx from 'clsx';\r\nimport MessageIcon from '@material-ui/icons/Message';\r\nimport PeopleAltIcon from '@material-ui/icons/PeopleAlt';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Drawer from '@material-ui/core/Drawer';\r\nimport Button from '@material-ui/core/Button';\r\nimport List from '@material-ui/core/List';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport InboxIcon from '@material-ui/icons/MoveToInbox';\r\nimport MailIcon from '@material-ui/icons/Mail';\r\nimport { IconButton } from '@material-ui/core';\r\nimport RouterLink from '../RouterLink/RouterLink';\r\n\r\nconst useStyles = makeStyles({\r\n    list: {\r\n        width: 250,\r\n    },\r\n    fullList: {\r\n        width: 'auto',\r\n    },\r\n});\r\n\r\nexport default function Sidebar({ icon }) {\r\n    const classes = useStyles();\r\n    const [state, setState] = React.useState({\r\n        top: false,\r\n        left: false,\r\n        bottom: false,\r\n        right: false,\r\n    });\r\n\r\n    const toggleDrawer = (anchor, open) => (event) => {\r\n        if (event.type === 'keydown' && (event.key === 'Tab' || event.key === 'Shift')) {\r\n            return;\r\n        }\r\n\r\n        setState({ ...state, [anchor]: open });\r\n    };\r\n\r\n    const list = (anchor) => (\r\n        <div\r\n            className={clsx(classes.list, {\r\n                [classes.fullList]: anchor === 'top' || anchor === 'bottom',\r\n            })}\r\n            role=\"presentation\"\r\n            onClick={toggleDrawer(anchor, false)}\r\n            onKeyDown={toggleDrawer(anchor, false)}\r\n        >\r\n            <List>\r\n                <RouterLink to=\"/friends\">\r\n                    <ListItem button >\r\n                        <ListItemIcon><PeopleAltIcon></PeopleAltIcon></ListItemIcon>\r\n                        <ListItemText primary=\"Friends\" />\r\n                    </ListItem>\r\n                </RouterLink>\r\n\r\n\r\n                <RouterLink to=\"/chat\">\r\n                    <ListItem button >\r\n                        <ListItemIcon><MessageIcon></MessageIcon></ListItemIcon>\r\n                        <ListItemText primary=\"Chat\" />\r\n                    </ListItem>\r\n                </RouterLink>\r\n            </List>\r\n        </div >\r\n    );\r\n    const anchor = 'left';\r\n    return (\r\n        <React.Fragment key={anchor}>\r\n            <IconButton color=\"inherit\" onClick={toggleDrawer(anchor, true)}>{icon}</IconButton>\r\n            <Drawer anchor={anchor} open={state[anchor]} onClose={toggleDrawer(anchor, false)}>\r\n                {list(anchor)}\r\n            </Drawer>\r\n        </React.Fragment>\r\n    );\r\n}\r\n","import React from 'react'\r\nimport MyAvatar from '../MyAvatar/MyAvatar';\r\nimport AppBar from '@material-ui/core/AppBar'\r\nimport Toolbar from '@material-ui/core/Toolbar'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport { Box, Button, Hidden, IconButton, makeStyles } from '@material-ui/core'\r\n\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport PersonIcon from '@material-ui/icons/Person';\r\nimport Slt from '../../defines/Slt'\r\nimport { Link, useHistory, useLocation } from 'react-router-dom'\r\nimport { useSelector, useDispatch } from 'react-redux'\r\nimport { isLogged, authUser, status } from '../../features/auth/authSlice'\r\nimport { signOut } from '../../features/auth/authSlice';\r\nimport { useCookies } from 'react-cookie'\r\nimport DayNightSwitch from '../DayNightSwitch/DayNightSwitch'\r\nimport Notifications from '../Notifications/Notifications';\r\nimport RunAction from '../RunAction/RunAction';\r\nimport { LOGGED_USER } from '../../defines/CookieName';\r\nimport Sidebar from '../Sidebar/Sidebar';\r\n\r\nexport default function Header(props) {\r\n    const [cookies, setCookie, removeCookie] = useCookies(LOGGED_USER);\r\n    const user = useSelector(authUser);\r\n    const dispatch = useDispatch();\r\n    const logged = useSelector(isLogged);\r\n    const authStatus = useSelector(status);\r\n    const location = useLocation();\r\n    const pathName = location.pathname;\r\n    const history = useHistory();\r\n\r\n    const onSignout = () => {\r\n        removeCookie(LOGGED_USER);\r\n        dispatch(signOut());\r\n        history.push('/');\r\n    }\r\n\r\n    const toolsHtml = (\r\n        <Box display=\"flex\" alignItems=\"center\" justifyContent=\"flex-end\" flexGrow={1}>\r\n            <Hidden smDown>\r\n                <Box mr={4}>\r\n                    {logged\r\n                        ? <Notifications></Notifications>\r\n                        : null\r\n                    }\r\n                </Box>\r\n            </Hidden>\r\n            {/* \r\n            <RunAction></RunAction>\r\n             */}\r\n            <DayNightSwitch></DayNightSwitch>\r\n            {(logged)\r\n                ? (\r\n                    <MyAvatar name={user.name} single={user.single} picture={user.picture}></MyAvatar>\r\n                )\r\n                : null}\r\n            <Button\r\n                disabled={pathName === '/login'}\r\n                startIcon={(!logged)\r\n                    ? <PersonIcon></PersonIcon>\r\n                    : null}\r\n                color=\"inherit\"\r\n                onClick={() => {\r\n                    onSignout();\r\n                }}>\r\n                <Typography >{(logged)\r\n                    ? 'Sign out'\r\n                    : 'Sign in'}</Typography>\r\n            </Button>\r\n        </Box>\r\n    )\r\n\r\n    return (\r\n        <AppBar className=\"header\" position=\"static\" color=\"primary\" id={Slt.mainAppBar}>\r\n            <Toolbar >\r\n                <Hidden mdUp>\r\n                    <Sidebar icon={<MenuIcon />}> </Sidebar>\r\n                </Hidden>\r\n                <Typography variant=\"h6\">\r\n                    <Link to=\"/chat\" color=\"inherit\" style={{ color: 'white', textDecoration: 'none' }}>\r\n                        Messenger\r\n                        </Link>\r\n                </Typography>\r\n                {(authStatus !== 'loading') ? toolsHtml : null}\r\n            </Toolbar>\r\n        </AppBar>\r\n    )\r\n}\r\n","import { createStyles, makeStyles } from \"@material-ui/core\";\r\n\r\nconst colors = {\r\n    lightGray: '#F0F2F5',\r\n}\r\n\r\nconst mainStyles = makeStyles(theme => createStyles({\r\n    table: {\r\n        minWidth: 650\r\n    },\r\n    chatSection: {\r\n        width: '100%',\r\n        height: '400px',\r\n        overflow: 'auto'\r\n    },\r\n    headBG: {\r\n        backgroundColor: '#e0e0e0'\r\n    },\r\n    borderRight500: {\r\n        borderRight: '1px solid #e0e0e0'\r\n    },\r\n    borderLeft500: {\r\n        borderLeft: '1px solid #e0e0e0'\r\n    },\r\n    messageArea: {\r\n        height: '70vh',\r\n        overflowY: 'auto'\r\n    },\r\n    RoundLightGrayInputStyle: {\r\n        paddingLeft: '10px',\r\n        paddingRight: '10px',\r\n        backgroundColor: colors.lightGray,\r\n        borderRadius: '50px',\r\n    },\r\n    buttonStyle: {\r\n        textTransform: 'none',\r\n    },\r\n    flexCenterVerticalStyle: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n    },\r\n    flexCenterStyle: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n    },\r\n    defaultContainerPaddingStyle: {\r\n        root: {\r\n            '& > *': {\r\n                padding: theme.spacing(2),\r\n            }\r\n        }\r\n    }\r\n}));\r\n\r\nexport default mainStyles;","import React from 'react';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport AvatarGroup from '@material-ui/lab/AvatarGroup';\r\n\r\nexport default function MyAvatarGroup({ items, max = 2 }) {\r\n    const avatars = items.slice(0, max).map((item, index) => {\r\n        return <Avatar key={index} alt={item.name} src={item.src} />;\r\n    })\r\n    return (\r\n        <AvatarGroup max={max} spacing=\"small\">\r\n            {avatars}\r\n        </AvatarGroup>\r\n    );\r\n}\r\n","import Axios from \"axios\";\r\nimport { API_ADDRESS } from \"../Config\";\r\nimport Helper from \"../Helper\";\r\nimport MySocket from '../Socket/MySocket';\r\n\r\nconst prefix = `${API_ADDRESS}/conversation`;\r\n\r\nconst ConversationApi = {\r\n    findConversationById: async function (id) {\r\n        const data = await Axios.get(`${prefix}/getConversationById`, {\r\n            params: {\r\n                id\r\n            }\r\n        });\r\n        return data.data;\r\n    },\r\n    findConversationByMemberIds: async function (ids) {\r\n        const data = await Axios.post(`${prefix}/getConversationByMemberIds`, {\r\n            ids\r\n        });\r\n        return data.data;\r\n    },\r\n    findSidebarConversationById: async function (id) {\r\n        const data = await Axios.get(`${prefix}/getSidebarConversationById`, {\r\n            params: {\r\n                id\r\n            }\r\n        });\r\n        return data.data;\r\n    },\r\n    listConversationsForListDisplay: async function (id) {\r\n        const data = await Axios.get(`${prefix}/listConversationsForListDisplay`, {\r\n            params: {\r\n                id\r\n            }\r\n        });\r\n        return data.data;\r\n    },\r\n    findConversationInfoByUserIdsOrCreateIfNotExist: async function (ids) {\r\n        const data = await Axios.post(`${prefix}/getConversationInfoByUserIdsOrCreateIfNotExist`, { ids });\r\n        return data.data;\r\n    },\r\n    getHomeConversation: async function () {\r\n        const data = await Axios.get(`${prefix}/home`);\r\n        return data.data;\r\n    },\r\n    createConversationWithMemberIds: async function (ids, messageParams = null) {\r\n        const data = await Axios.post(`${prefix}/createConversationWithMemberIds`, { ids, messageParams });\r\n        return data.data;\r\n    }\r\n}\r\nexport default ConversationApi;","import { createAsyncThunk, createSlice } from '@reduxjs/toolkit'\r\nimport ConversationApi from '../../defines/https/ConversationApi';\r\n\r\nexport const fetchConversationByMemberIds = createAsyncThunk('chat/conversation', async (ids) => {\r\n    const response = await ConversationApi.findConversationByMemberIds(ids);\r\n    return response;\r\n})\r\n\r\nexport const fetchConversationById = createAsyncThunk('chat/conversation', async (id) => {\r\n    const response = await ConversationApi.findConversationById(id);\r\n    return response;\r\n})\r\n\r\nexport const fetchConversationByUserIdsOrCreateIfNotExist = createAsyncThunk('chat/conversation', async (ids) => {\r\n    const response = await ConversationApi.findConversationByUserIdsOrCreateIfNotExist(ids);\r\n    return response;\r\n})\r\n\r\nexport const fetchHomeConversation = createAsyncThunk('chat/conversation', async () => {\r\n    const response = await ConversationApi.getHomeConversation();\r\n    return response;\r\n})\r\n\r\nconst initialState = {\r\n    conversation: {},\r\n    sidebarConversations: [],\r\n    status: 'idle',\r\n    error: null,\r\n}\r\n\r\nconst ChatSlice = createSlice({\r\n    name: 'chat',\r\n    initialState,\r\n    reducers: {\r\n        appendMessage: (state, action) => {\r\n            state.conversation.messages.push(action.payload);\r\n        },\r\n        reset: (state, action) => {\r\n            state.conversation = {};\r\n            state.status = 'idle';\r\n            state.error = null;\r\n        }\r\n    },\r\n    extraReducers: {\r\n        'chat/conversation/pending': (state, action) => {\r\n            state.status = 'loading'\r\n        },\r\n        'chat/conversation/fulfilled': (state, action) => {\r\n            const { payload, status } = action.payload;\r\n\r\n            if (status === 'succeeded') {\r\n                state.conversation = payload;\r\n                state.error = null;\r\n            } else state.error = 'not found';\r\n            state.status = 'succeeded'\r\n        },\r\n        'chat/conversation/rejected': (state, action) => {\r\n            state.error = action.error.message\r\n            state.status = 'failed'\r\n        },\r\n    }\r\n});\r\n\r\nconst selectors = {\r\n    conversation: (state) => {\r\n        return state.chat.conversation;\r\n    },\r\n    conversationMessages: (state) => {\r\n        return state.chat.conversation.messages || [];\r\n    },\r\n    conversationId: (state) => {\r\n        return state.chat.conversation._id;\r\n    },\r\n    conversationStatus: (state) => {\r\n        return state.chat.status;\r\n    },\r\n    conversationError: (state) => {\r\n        return state.chat.error;\r\n    },\r\n    conversationMemberIds: (state) => {\r\n        return state.chat.conversation.members;\r\n    }\r\n}\r\n\r\nexport const { conversationStatus, conversationError, conversation, conversationMemberIds, conversationId, conversationMessages } = selectors;\r\n\r\nexport const { reset, appendMessage } = ChatSlice.actions\r\n\r\nexport default ChatSlice.reducer;","import { Box } from '@material-ui/core';\r\nimport React from 'react'\r\nimport { useSelector } from 'react-redux';\r\nimport { useHistory } from 'react-router-dom';\r\nimport Helper from '../../defines/Helper';\r\nimport ConversationApi from '../../defines/https/ConversationApi';\r\nimport MySocket from '../../defines/Socket/MySocket';\r\nimport { authUser } from '../../features/auth/authSlice';\r\nimport { conversationMemberIds } from '../../features/chat/ChatSlice';\r\n\r\nexport default function ConversationLink({ children, item, ...rest }) {\r\n    const history = useHistory();\r\n    const user = useSelector(authUser) || {};\r\n    const convoMemberIds = useSelector(conversationMemberIds);\r\n    const onItemClick = async () => {\r\n        const showConversation = async () => {\r\n            const data = await ConversationApi.findConversationInfoByUserIdsOrCreateIfNotExist([user._id, item._id]);\r\n            const { status, payload } = data;\r\n            if (status === 'succeeded') {\r\n                const { members, isNew, _id: conversationId } = payload;\r\n                if (isNew) {\r\n                    //const memberIds = Helper.getArrayOfFieldValue(members, '_id', 'string');\r\n                    MySocket.emitJoinUsersToConversation(members, conversationId);\r\n                }\r\n                const { _id } = data.payload;\r\n                history.push(`/chat/t/${_id}`);\r\n            }\r\n        }\r\n        if (!convoMemberIds) await showConversation();\r\n        else if (Helper.arrayDiff(convoMemberIds, [user._id, item._id]).length > 0) await showConversation();\r\n    }\r\n    return (\r\n        <Box {...rest} onClick={onItemClick}> {children}</Box>\r\n    )\r\n}\r\n","import React from 'react'\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport MyAvatar from '../MyAvatar/MyAvatar';\r\nimport MyAvatarGroup from '../MyAvatarGroup/MyAvatarGroup';\r\nimport { Avatar, Box, Hidden, ListItemAvatar, makeStyles, Tooltip } from '@material-ui/core';\r\nimport { authUser } from '../../features/auth/authSlice';\r\nimport { useSelector } from 'react-redux';\r\nimport ConversationLink from '../ConversationLink/ConversationLink';\r\nimport RouterLink from '../RouterLink/RouterLink';\r\nimport { conversationId } from '../../features/chat/ChatSlice';\r\n\r\nconst useStyle = makeStyles({\r\n    truncateListItemStyle: {\r\n        '& > p': {\r\n            overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap'\r\n        }\r\n    }\r\n})\r\n\r\nconst GenerateAvatarGroup = ({ items }) => {\r\n    items = items.map((item) => {\r\n        return {\r\n            name: item.username,\r\n            src: item.picture,\r\n        }\r\n    })\r\n    return <MyAvatarGroup items={items}></MyAvatarGroup>\r\n}\r\n\r\n\r\nexport default function ConversationItem({ item, online, icon }) {\r\n    const classes = useStyle();\r\n    const user = useSelector(authUser);\r\n    const convoId = useSelector(conversationId);\r\n    const { members } = item;\r\n    const friends = members.filter((item) => {\r\n        return item._id !== user._id;\r\n    })\r\n    let name, lastMessageText = null;\r\n    if (members.length === 2) {\r\n        name = friends[0].username;\r\n    } else {\r\n        name = `${friends[0].username} and ${friends.length - 1} others`;\r\n    }\r\n    if (item.lastMessage) {\r\n        let prefix = (item.lastMessage) ? (item.lastMessage.from._id === user._id ? 'you: ' : (friends.length > 1 ? `${item.lastMessage.from.username}: ` : null)) : null;\r\n        lastMessageText = prefix !== null ? `${prefix} ${item.lastMessage.text}` : item.lastMessage.text;\r\n    }\r\n\r\n    const title = friends.reduce((accumulator, currentVal) => {\r\n        return `${accumulator}, ${currentVal.username}`;\r\n    }, '').replace(/^, /, '');\r\n    return (\r\n        <RouterLink to={`/chat/t/${item._id}`}>\r\n            <Tooltip title={title}>\r\n                <ListItem button selected={convoId === item._id}>\r\n                    <ListItemAvatar style={{ width: '90px', overflow: 'hidden' }}>\r\n                        {\r\n                            icon ? (<Avatar> {icon} </Avatar>) :\r\n                                (\r\n                                    members.length === 2\r\n                                        ? <MyAvatar online={online} name={name} single={true} picture={friends[0].picture}></MyAvatar>\r\n                                        : <GenerateAvatarGroup items={friends}></GenerateAvatarGroup>\r\n                                )\r\n                        }\r\n                    </ListItemAvatar>\r\n                    <Hidden xsDown>\r\n                        <ListItemText className={classes.truncateListItemStyle} primary={name} secondary={lastMessageText}></ListItemText>\r\n                    </Hidden>\r\n                </ListItem >\r\n            </Tooltip>\r\n        </RouterLink>\r\n    )\r\n}\r\n","import { createAsyncThunk, createEntityAdapter, createSlice } from '@reduxjs/toolkit'\r\nimport ConversationApi from '../../defines/https/ConversationApi';\r\n\r\nexport const fetchConversations = createAsyncThunk('sidebarConversations/fetchConversations', async ({ id }) => {\r\n    const response = await ConversationApi.listConversationsForListDisplay(id)\r\n    return response;\r\n})\r\n\r\nexport const fetchAndPrependConversationById = createAsyncThunk('sidebarConversations/fetchAndPrependConversationById', async ({ id }) => {\r\n    const response = await ConversationApi.findSidebarConversationById(id)\r\n    return response;\r\n})\r\n\r\nconst conversationsAdapter = createEntityAdapter({\r\n    selectId: item => item._id,\r\n    sortComparer: (a, b) => -(a.lastMessage.time - b.lastMessage.time)\r\n})\r\n\r\nconst initialState = conversationsAdapter.getInitialState({\r\n    status: 'idle',\r\n    error: null\r\n})\r\n\r\n\r\nconst SidebarConversationsSlice = createSlice({\r\n    name: 'sidebarConversations',\r\n    initialState,\r\n    reducers: {\r\n        updateLastMessage: (state, action) => {\r\n            const { id, message } = action.payload;\r\n            const item = state.entities[id];\r\n            if (item) {\r\n                item.lastMessage = message;\r\n                conversationsAdapter.upsertOne(state, item)\r\n            } else {\r\n                fetchAndPrependConversationById({ id });\r\n            }\r\n        }\r\n    },\r\n    extraReducers: {\r\n        [fetchAndPrependConversationById.fulfilled]: (state, action) => {\r\n            const { payload, status } = action.payload;\r\n            if (status === 'succeeded') conversationsAdapter.upsertOne(state, payload);\r\n        },\r\n        [fetchConversations.pending]: (state, action) => {\r\n            state.status = 'loading'\r\n        },\r\n        [fetchConversations.fulfilled]: (state, action) => {\r\n            const { payload, status } = action.payload;\r\n            if (status === 'succeeded') {\r\n                conversationsAdapter.upsertMany(state, payload)\r\n                state.error = null;\r\n            } else state.error = 'not found';\r\n            state.status = 'succeeded'\r\n        },\r\n\r\n    }\r\n\r\n});\r\n\r\nconst selectors = {\r\n    isConversationExist: (state, id) => {\r\n        return (state.sidebarConversations.ids.indexOf(id) > -1)\r\n    }\r\n}\r\n\r\nexport const { isConversationExist } = selectors;\r\nexport const {\r\n    selectAll: selectAllSidebarConversations,\r\n    selectById: selectSidebarConversationById,\r\n    selectIds: selectSidebarConversationIds\r\n    // Pass in a selector that returns the posts slice of state\r\n} = conversationsAdapter.getSelectors(state => state.sidebarConversations)\r\n\r\n\r\nexport const {\r\n    updateLastMessage\r\n} = SidebarConversationsSlice.actions\r\nexport default SidebarConversationsSlice.reducer","import React, { useEffect, useState } from 'react'\r\nimport Grid from '@material-ui/core/Grid'\r\nimport SearchBar from '../SearchBar/SearchBar'\r\nimport { Box, Hidden } from '@material-ui/core'\r\nimport mainStyles from '../../defines/styles/MainStyles'\r\n\r\nimport List from '@material-ui/core/List';\r\nimport ConversationItem from '../ConversationItem/ConversationItem'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { fetchAndPrependConversationById, fetchConversations, selectAllSidebarConversations, selectSidebarConversationIds, updateLastMessage } from '../../features/sidebarConversations/SidebarConversationsSlice'\r\nimport { authUser } from '../../features/auth/authSlice'\r\nimport MySocket from '../../defines/Socket/MySocket'\r\nimport SocketEventName from '../../defines/Socket/SocketEventName'\r\nimport Socket from '../../defines/Socket'\r\nimport { conversationId } from '../../features/chat/ChatSlice'\r\n\r\n\r\nexport default function ConversationList() {\r\n    const classes = mainStyles();\r\n    const dispatch = useDispatch();\r\n    const conversations = useSelector(selectAllSidebarConversations);\r\n    const loggedUser = useSelector(authUser);\r\n    const ids = useSelector(selectSidebarConversationIds);\r\n    const convoId = useSelector(conversationId);\r\n\r\n    useEffect(() => {\r\n        dispatch(fetchConversations({ id: loggedUser._id }));\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        const myFunc = (data) => {\r\n            const { message, conversationId } = data;\r\n            if (ids.indexOf(conversationId) > -1) {\r\n                dispatch(updateLastMessage({ id: conversationId, message }));\r\n            } else {\r\n                dispatch(fetchAndPrependConversationById({ id: conversationId }));\r\n            }\r\n        }\r\n        MySocket.onNewMessageNotification(myFunc)\r\n        return () => {\r\n            Socket.removeListener(SocketEventName.newMessageNotification, myFunc);\r\n        }\r\n    }, [convoId, ids])\r\n\r\n\r\n    const conversationsHtml = conversations.map((item, i) => {\r\n        return (\r\n            <ConversationItem key={i} item={item}></ConversationItem>\r\n        )\r\n    })\r\n\r\n    return (\r\n        <List className=\"left-sidebar custom-scrollbar\">\r\n            {conversationsHtml}\r\n        </List>\r\n    )\r\n}\r\n\r\n        //{/* \r\n         //*/}\r\n        //<Grid className=\"left-sidebar\" container >\r\n            //{/* SEARCH BAR */}\r\n            //{/* \r\n            //<Grid item xs={12}>\r\n                //<Box my={2}>\r\n                    //<SearchBar></SearchBar>\r\n                //</Box>\r\n            //</Grid>\r\n             //*/}\r\n\r\n            //<Grid item xs={12} >\r\n                //{/* \r\n                //<Box mt={2} >\r\n                    //<HomeConversationItem></HomeConversationItem>\r\n                //</Box>\r\n                 //*/}\r\n            //</Grid>\r\n        //</Grid>\r\n","import { createSlice } from '@reduxjs/toolkit'\r\nconst initialState = {\r\n    enabled: false,\r\n    receivers: [],\r\n}\r\n\r\nconst NewChatSlice = createSlice({\r\n    name: 'newChat',\r\n    initialState,\r\n    reducers: {\r\n        setEnabled: (state, action) => {\r\n            state.enabled = action.payload;\r\n        },\r\n        removeReceiverById: (state, action) => {\r\n            state.receivers = state.receivers.filter((item) => {\r\n                return item._id !== action.payload;\r\n            })\r\n        },\r\n        appendReceiver: (state, action) => {\r\n            state.receivers.push(action.payload);\r\n        },\r\n        removeLastReceiver: (state, action) => {\r\n            if (state.receivers.length > 0) {\r\n                state.receivers = (state.receivers.slice(0, -1));\r\n            }\r\n        },\r\n        reset: (state, action) => {\r\n            state.enabled = initialState.enabled;\r\n            state.receivers = initialState.receivers;\r\n        }\r\n    }\r\n});\r\n\r\nconst selectors = {\r\n    isNewChatEnable: (state) => {\r\n        return state.newChat.enabled\r\n    },\r\n    newChatReceivers: (state) => {\r\n        return state.newChat.receivers\r\n    },\r\n    newChatReceiver: (state) => {\r\n        if (state.newChat.receivers.length === 1) return state.newChat.receivers[0];\r\n        return null;\r\n    }\r\n}\r\n\r\nexport const { newChatReceivers, isNewChatEnable, newChatReceiver } = selectors;\r\n\r\nexport const {\r\n    removeReceiverById: removeNewChatReceiverById,\r\n    appendReceiver: appendNewChatReceiver,\r\n    removeLastReceiver: removeLastNewChatReceiver,\r\n    setEnabled: setNewChatEnabled,\r\n    reset: resetNewChat,\r\n} = NewChatSlice.actions\r\nexport default NewChatSlice.reducer","import { Typography } from '@material-ui/core'\r\nimport React from 'react'\r\n\r\nexport default function Loading() {\r\n    return (\r\n        <Typography align=\"center\" className=\"text-muted\">Loading...</Typography>\r\n    )\r\n}\r\n","import { Box, Grid, Tooltip, Typography } from '@material-ui/core'\r\nimport React from 'react'\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport MyAvatar from '../MyAvatar/MyAvatar';\r\nimport MyTime from '../../defines/MyTime';\r\n\r\nexport default function Message({ notShowAvatar, ownMessage, time, user, message }) {\r\n    const avatar = !notShowAvatar ? (<MyAvatar sizeInPixel={20} name={user.username} picture={user.picture}></MyAvatar>) : null;\r\n    const position = (ownMessage) ? 'right' : 'left';\r\n    const flexPos = (ownMessage) ? 'flex-end' : 'flex-start';\r\n    const placement = (ownMessage) ? 'bottom-start' : 'bottom-end';\r\n    return (\r\n        <ListItem key=\"1\">\r\n            <Box width=\"100%\" style={{ display: 'flex', justifyContent: flexPos, alignItems: 'flex-end' }}>\r\n                {/* AVATAR */}\r\n                {!ownMessage ? avatar : null}\r\n\r\n                {/* MESSAGE AND TIME */}\r\n                <Box className={`message ${position}-message ${!ownMessage && notShowAvatar ? 'ml-avatar' : ''}`}>\r\n                    <Tooltip title={MyTime.getMessageTimeString(MyTime.getCurrentTimeByUTCTime(time))} placement={placement}>\r\n                        <ListItemText align={position} primary={message} ></ListItemText>\r\n                    </Tooltip>\r\n                </Box>\r\n            </Box>\r\n\r\n        </ListItem>\r\n    )\r\n}\r\n","import { Typography } from '@material-ui/core'\r\nimport React from 'react'\r\n\r\nexport default function ChatNotification({ username, type }) {\r\n    let usernameHtml = <Typography component=\"span\" color=\"primary\">{username}</Typography>;\r\n    let content;\r\n    switch (type) {\r\n        case 'welcome-current-user-notification':\r\n            content = 'Welcome to the chat room.';\r\n            break;\r\n        case 'welcome-other-user-notification':\r\n            content = <span>{usernameHtml} has joined the chat.</span>;\r\n            break;\r\n        case 'user-left-notification':\r\n            content = <span>{usernameHtml} has left the chat.</span>;\r\n            break;\r\n        default:\r\n            content = '';\r\n    }\r\n    return (\r\n        <Typography align=\"center\" className=\"text-muted\">{content}</Typography>\r\n    )\r\n}\r\n","import React, { useEffect, useState } from 'react'\r\nimport { Box, List, Typography } from '@material-ui/core'\r\nimport Message from '../Message/Message'\r\nimport mainStyle from '../../defines/styles/MainStyles'\r\nimport { useSelector } from 'react-redux';\r\nimport { authUser } from '../../features/auth/authSlice';\r\nimport ChatNotification from '../ChatNotification/ChatNotification';\r\nimport './Messages.css'\r\nimport { isNewChatEnable } from '../../features/NewChat/NewChatSlice';\r\n\r\nconst emptyHtml = (\r\n    <React.Fragment>\r\n        <Box mt={4}>\r\n            <Typography className=\"text-muted\" align=\"center\" >Let's start a conversation.</Typography>\r\n        </Box>\r\n    </React.Fragment>\r\n)\r\n\r\nconst scroll = () => {\r\n    let containers = document.getElementsByClassName('chat-box-messages-wrapper');\r\n    containers[0].scrollTop = containers[0].scrollHeight;\r\n}\r\n\r\nexport default function Messages({ messages }) {\r\n    const user = useSelector(authUser);\r\n    const newChatEnabled = useSelector(isNewChatEnable);\r\n\r\n    // messages\r\n    const messagesHtml = messages.map((item, index) => {\r\n        if (item.from) {\r\n            let notShowAvatar = false;\r\n            if (index < messages.length - 1) {\r\n                const nextItem = messages[index + 1];\r\n                notShowAvatar = (nextItem.type === 'message') ? nextItem.from.username === item.from.username : false;\r\n            }\r\n            return <Message notShowAvatar={notShowAvatar} ownMessage={item.from.username === user.username} key={index} user={item.from} message={item.text} time={item.time}></Message>\r\n        } else {\r\n            return <ChatNotification key={index} username={item.user.username} type={item.type}></ChatNotification>\r\n        }\r\n    })\r\n\r\n    useEffect(() => {\r\n        scroll();\r\n    }, [messages])\r\n\r\n    return (\r\n        <List className=\"chat-box-messages-wrapper custom-scrollbar\" >\r\n            {messagesHtml.length > 0 ? messagesHtml : (!newChatEnabled ? emptyHtml : null)}\r\n        </List>\r\n    )\r\n}\r\n","import React, { useState } from 'react'\r\nimport { Grid, TextField, Fab, Button, IconButton } from '@material-ui/core'\r\nimport { Send as SendIcon } from '@material-ui/icons'\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { setNotify } from '../../features/notify/NotifySlice';\r\nimport MySocket from '../../defines/Socket/MySocket';\r\nimport { authUser } from '../../features/auth/authSlice';\r\nimport { conversation } from '../../features/chat/ChatSlice';\r\nimport Message from '../../defines/Message';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { isNewChatEnable, newChatReceivers } from '../../features/NewChat/NewChatSlice';\r\nimport Helper from '../../defines/Helper';\r\nimport ConversationApi from '../../defines/https/ConversationApi';\r\n\r\nlet myTimeoutObj;\r\nexport default function SendingInput() {\r\n    const [inputMsg, setInputMsg] = useState('');\r\n    const [isTyping, setTyping] = useState(false);\r\n    const dispatch = useDispatch();\r\n    const history = useHistory();\r\n    const user = useSelector(authUser);\r\n    const convo = useSelector(conversation);\r\n    const receivers = useSelector(newChatReceivers);\r\n    const newChatEnabled = useSelector(isNewChatEnable);\r\n\r\n    // INPUT CHANGE\r\n    const onInputChange = (e) => {\r\n        setInputMsg(e.target.value);\r\n    }\r\n\r\n    // ON SENDING MESSAGE\r\n    const onSendingMessageClick = (e) => {\r\n        e.preventDefault();\r\n\r\n        if (inputMsg.trim() === '') dispatch(setNotify({ message: Message.PleaseTypeMessage, open: true, timeout: 2000 }))\r\n        else {\r\n            if (convo._id) {\r\n                onSendingMessage();\r\n            } else {\r\n                if (newChatEnabled && receivers.length > 0) {\r\n                    onCreateConversationsWithReceicersAndFristMessage();\r\n                } else {\r\n                    dispatch(setNotify({ message: Message.PleaseChooseReceiver, open: true, timeout: 2000 }))\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    const onSendingMessage = () => {\r\n        //MySocket.emitSendMessage(user, inputMsg);\r\n        MySocket.emitSendMessage(user, inputMsg, convo._id);\r\n        setInputMsg('');\r\n        if (newChatEnabled) history.push(`/chat/t/${convo._id}`)\r\n    }\r\n\r\n    const onCreateConversationsWithReceicersAndFristMessage = async () => {\r\n        const receiverIds = Helper.getArrayOfFieldValue(receivers, '_id').concat(user._id);\r\n        const data = await ConversationApi.createConversationWithMemberIds(receiverIds);\r\n        const { status, payload } = data;\r\n        if (status === 'succeeded') {\r\n            MySocket.emitJoinUsersToConversation(payload.members, payload._id);\r\n            MySocket.emitSendMessage(user, inputMsg, payload._id);\r\n            setInputMsg('');\r\n            history.push(`/chat/t/${payload._id}`);\r\n        }\r\n    }\r\n\r\n    const emitTyping = () => {\r\n        if (!isTyping && inputMsg.trim() !== '') MySocket.emitTyping(user, convo._id);\r\n        setTyping(true);\r\n        clearTimeout(myTimeoutObj);\r\n        myTimeoutObj = setTimeout(() => {\r\n            emitStopTyping();\r\n        }, 2000);\r\n    }\r\n\r\n    const emitStopTyping = () => {\r\n        if (isTyping) {\r\n            MySocket.emitStopTyping(user.username, convo._id);\r\n            setTyping(false);\r\n        }\r\n    }\r\n\r\n    // SOLVE TYPING\r\n    const onKeyUp = (e) => {\r\n        if (e.which !== 13) {\r\n            if (inputMsg.length > 3) emitTyping();\r\n        } else {\r\n            emitStopTyping();\r\n        }\r\n    }\r\n\r\n    const onBlur = () => {\r\n        emitStopTyping();\r\n    }\r\n\r\n    return (\r\n        <form onSubmit={(e) => { onSendingMessageClick(e) }}>\r\n            <Grid container >\r\n                <Grid item xs={10} md={11}>\r\n                    <TextField\r\n                    style={{padding: '0 8px'}}\r\n                        autoFocus={true}\r\n                        inputProps={{\r\n                            autoComplete: 'off'\r\n                        }}\r\n                        value={inputMsg} id=\"outlined-basic-email\" fullWidth onChange={onInputChange} onKeyUp={onKeyUp} onBlur={onBlur} />\r\n                </Grid>\r\n                <Grid item xs={2} md={1} align=\"center\">\r\n                    <IconButton color=\"primary\" type=\"submit\"> <SendIcon /> </IconButton>\r\n                </Grid>\r\n            </Grid>\r\n        </form >\r\n    )\r\n}\r\n","import { createSlice } from '@reduxjs/toolkit'\r\n\r\nconst initialState = {\r\n    message: '',\r\n    type: '',\r\n    open: false,\r\n    timeout: 4000,\r\n}\r\n\r\nconst NotifySlice = createSlice({\r\n    name: 'notify',\r\n    initialState,\r\n    reducers: {\r\n        setNotify: (state, action) => {\r\n            const { message, type, open, timeout } = action.payload;\r\n            if (open) {\r\n                state.message = message || '';\r\n                state.type = type || '';\r\n                state.timeout = timeout || 6000;\r\n            }\r\n            state.open = open || false;\r\n        }\r\n    }\r\n})\r\n\r\nconst selectors = {\r\n    open: (state) => {\r\n        return state.notify.open;\r\n    },\r\n    message: (state) => {\r\n        return state.notify.message;\r\n    },\r\n    type: (state) => {\r\n        return state.notify.type;\r\n    },\r\n    timeout: (state) => {\r\n        return state.notify.timeout;\r\n    },\r\n};\r\nexport const { open, message, type, timeout } = selectors;\r\n\r\nexport const {\r\n    setNotify\r\n} = NotifySlice.actions\r\nexport default NotifySlice.reducer;","const Message = {\r\n    // form\r\n    invalid: `{0} invalid`,\r\n\r\n    // system\r\n    fail: `Something went wrong`,\r\n    welcomeNewAccount: `Hello {0}, let's start a chat with your fiends!`,\r\n    PleaseTypeMessage: `Please type some message to send!`,\r\n    PleaseChooseReceiver: `Please choose receiver!`,\r\n    newMessage: `{0}: {1}`,\r\n\r\n    // friend\r\n    friendRequested: `{0} sent you a friend request.`,\r\n    unfriended: `{0} unfriended you.`,\r\n    friendAccepted: `{0} accepted your friend request.`,\r\n\r\n\r\n}\r\nexport default Message;","import { Box, Paper } from '@material-ui/core'\r\nimport React from 'react'\r\nimport SendingInput from '../SendingInput/SendingInput'\r\n\r\nexport default function SendMessageBar({ type }) {\r\n    return (\r\n        <Paper style={{boxShadow:'none'}} className=\"sending-message-bar-wrapper\">\r\n            <SendingInput type={type}></SendingInput>\r\n        </Paper>\r\n    )\r\n}\r\n","import { Paper } from '@material-ui/core';\r\nimport React, { useEffect, useState } from 'react'\r\nimport MySocket from '../../defines/Socket/MySocket'\r\nimport Socket from '../../defines/Socket'\r\nimport MyAvatar from '../MyAvatar/MyAvatar';\r\nimport SocketEventName from '../../defines/Socket/SocketEventName';\r\n\r\nexport default function UserTyping() {\r\n    const [typingUsers, setTypingUsers] = useState([]);\r\n    useEffect(() => {\r\n        MySocket.onTyping((data) => {\r\n            setTypingUsers(typingUsers.concat(data.user));\r\n        })\r\n        MySocket.onStopTyping((data) => {\r\n            setTypingUsers(typingUsers.filter((user) => {\r\n                return user.username !== data.username;\r\n            }));\r\n        })\r\n        return () => {\r\n            Socket.off(SocketEventName.typing);\r\n            Socket.off(SocketEventName.stopTyping);\r\n        }\r\n    })\r\n\r\n    const typingHtml = typingUsers.map((user) => {\r\n        return (\r\n            <div key={user._id}>\r\n                <div style={{ display: 'flex', alignItems: 'flex-start', }}>\r\n                    <span>\r\n                        <MyAvatar name={user.username} picture={user.picture}> </MyAvatar>\r\n                    </span>\r\n                    <img className=\"typing-icon\" src={`${process.env.PUBLIC_URL}/images/icons/typing-icon.gif`} alt=\"typing\" />\r\n                </div>\r\n            </div>\r\n        )\r\n    })\r\n    return (\r\n        <Paper elevation={0} style={{ minWidth: '200px' }}>\r\n            {(typingHtml.length > 0 ? typingHtml : null)}\r\n        </Paper>\r\n    )\r\n}\r\n","import { Box, Divider } from '@material-ui/core';\r\nimport React, { useEffect, useState } from 'react'\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { useHistory, useParams } from 'react-router-dom';\r\nimport ConversationApi from '../../defines/https/ConversationApi';\r\nimport Socket from '../../defines/Socket';\r\nimport MySocket from '../../defines/Socket/MySocket';\r\nimport SocketEventName from '../../defines/Socket/SocketEventName';\r\nimport { authUser, authUserId } from '../../features/auth/authSlice';\r\nimport { appendMessage, conversation, conversationError, conversationMessages, conversationStatus, fetchConversationById, fetchConversationByMemberIds, fetchHomeConversation, reset } from '../../features/chat/ChatSlice';\r\nimport { isNewChatEnable, newChatReceiver } from '../../features/NewChat/NewChatSlice';\r\nimport { updateLastMessage } from '../../features/sidebarConversations/SidebarConversationsSlice';\r\nimport Loading from '../Loading/Loading';\r\nimport Messages from '../Messages/Messages';\r\nimport SendMessageBar from '../SendMessageBar/SendMessageBar';\r\nimport UserTyping from '../UserTyping/UserTyping';\r\n\r\nexport default function NormalChat() {\r\n    const status = useSelector(conversationStatus);\r\n    const messages = useSelector(conversationMessages);\r\n    const convo = useSelector(conversation);\r\n    const dispatch = useDispatch();\r\n    const history = useHistory();\r\n    const loggedUserId = useSelector(authUserId);\r\n    const { conversationId } = useParams();;\r\n    const receiver = useSelector(newChatReceiver) || {};\r\n    const newChatEnabled = useSelector(isNewChatEnable);\r\n\r\n    // FETCH CONVERSATION BY RECEIVER ID\r\n    useEffect(() => {\r\n        if (newChatEnabled) {\r\n            if (receiver._id) dispatch(fetchConversationByMemberIds([`${loggedUserId}`, `${receiver._id}`]));\r\n            else {\r\n                dispatch(reset());\r\n            }\r\n        }\r\n    }, [receiver._id, newChatEnabled])\r\n\r\n    useEffect(() => {\r\n        if (status === 'succeeded') {\r\n            if (convo._id) MySocket.emitJoinRoom(`${convo._id}_current`);\r\n            else history.replace('/chat/new');\r\n        }\r\n        return () => {\r\n            if (convo._id) MySocket.emitLeaveRoom(`${convo._id}_current`);\r\n        }\r\n    }, [status, convo._id])\r\n\r\n    // FETCH CONVERSATION BY ID\r\n    useEffect(() => {\r\n        if (conversationId) dispatch(fetchConversationById(conversationId))\r\n    }, [conversationId]);\r\n\r\n    // reset\r\n    useEffect(() => {\r\n        return () => {\r\n            dispatch(reset())\r\n        }\r\n    }, [])\r\n\r\n    // SOCKET EVENTS RECEIVE MESSAGE\r\n    useEffect(() => {\r\n        MySocket.onReceiveMessage((data) => {\r\n            const { conversationId, message } = data;\r\n            if (conversationId === convo._id) {\r\n                const messageObj = {\r\n                    type: 'message',\r\n                    ...message\r\n                }\r\n                dispatch(appendMessage(messageObj));\r\n            }\r\n        })\r\n\r\n        return () => {\r\n            MySocket.off(SocketEventName.receiveMessage);\r\n        }\r\n    }, [messages, convo._id])\r\n\r\n    return (\r\n        <Box >\r\n            {status === 'loading'\r\n                ? <Loading></Loading>\r\n                : <Messages messages={messages}></Messages>\r\n            }\r\n        </Box>\r\n    )\r\n}","import { Avatar, Box, IconButton, ListItemText, TextField, Typography } from '@material-ui/core';\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport UserApi from '../../defines/https/UserApi'\r\nimport Helper from '../../defines/Helper'\r\nimport FolderIcon from '@material-ui/icons/Folder';\r\nimport Alert from '@material-ui/lab/Alert';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport './Receiver.css';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { authUserId } from '../../features/auth/authSlice';\r\nimport SuggestionUsers from '../SuggestionUsers/SuggestionUsers';\r\nimport { removeLastNewChatReceiver, newChatReceivers, removeNewChatReceiverById, appendNewChatReceiver } from '../../features/NewChat/NewChatSlice';\r\n\r\nlet timeout;\r\n\r\nconst SelectedUsers = ({ items, onCloseClick }) => {\r\n    return items.map((item) => {\r\n        return (\r\n            <Alert\r\n                key={item._id}\r\n                className=\"selected-receiver\"\r\n                severity=\"info\"\r\n                icon={false}\r\n                action={\r\n                    <IconButton\r\n                        aria-label=\"close\"\r\n                        color=\"inherit\"\r\n                        size=\"small\"\r\n                        onClick={() => { onCloseClick(item) }} >\r\n                        <CloseIcon fontSize=\"inherit\" />\r\n                    </IconButton>\r\n                }\r\n            > {item.username}</Alert>\r\n        )\r\n    })\r\n}\r\n\r\nexport default function Receiver({ onFriendIdSelected }) {\r\n    const dispatch = useDispatch();\r\n    const [mounted, setMounted] = useState(true);\r\n    const [suggestionUsers, setSuggestionUsers] = useState([]);\r\n    const [inputVal, setInputVal] = useState('');\r\n    const [receiverName, setReceiverName] = useState('');\r\n    const inputRef = useRef(null);\r\n    const loggedUserId = useSelector(authUserId)\r\n    const receivers = useSelector(newChatReceivers);\r\n\r\n    // fetch suggestion users\r\n    useEffect(() => {\r\n        setMounted(true);\r\n        const fetchUsers = async () => {\r\n            const data = await UserApi.findReceivers(receiverName, Helper.getArrayOfFieldValue(receivers, '_id').concat(loggedUserId));\r\n            const { status, payload } = data;\r\n            if (status === 'succeeded') {\r\n                if (mounted) {\r\n                    setSuggestionUsers(payload);\r\n                }\r\n            }\r\n        }\r\n        if (receiverName.trim() !== '') fetchUsers();\r\n        return () => {\r\n            setMounted(false);\r\n        }\r\n    }, [receiverName, receivers, loggedUserId])\r\n\r\n    useEffect(() => {\r\n        if (receivers.length === 1) onFriendIdSelected(receivers[0]._id);\r\n        else onFriendIdSelected(null);\r\n    }, [receivers])\r\n\r\n    // suggestion users\r\n    const onSuggestionUserClick = (item) => {\r\n        dispatch(appendNewChatReceiver(item));\r\n        setInputVal('');\r\n        setReceiverName('');\r\n        setSuggestionUsers([])\r\n        const input = inputRef.current.querySelector('input');\r\n        input.focus();\r\n    }\r\n\r\n    // selected users\r\n    const onRemoveSelectedUser = (item) => {\r\n        dispatch(removeNewChatReceiverById(item._id));\r\n    }\r\n\r\n    const solveSelectedUsers = (e, oldVal, newVal) => {\r\n        if (e.which === 8 && oldVal.trim() === '' && newVal.trim() === '') {\r\n            // pop\r\n            dispatch(removeLastNewChatReceiver());\r\n        }\r\n    }\r\n\r\n    // input events\r\n    const onInputChange = (e) => {\r\n        const value = e.target.value;\r\n        setInputVal(value);\r\n        clearTimeout(timeout);\r\n        timeout = setTimeout(() => {\r\n            setReceiverName(value);\r\n        }, 500);\r\n    }\r\n\r\n    const onInputKeyup = (e) => {\r\n        const value = e.target.value;\r\n        solveSelectedUsers(e, inputVal, value);\r\n    }\r\n\r\n    const onInputBlur = (e) => {\r\n        const value = e.target.value;\r\n        solveSelectedUsers(e, inputVal, value);\r\n    }\r\n\r\n    // render\r\n    return (\r\n        <Box className=\"receiver-wrapper\">\r\n            <Typography className=\"receiver-label\" >To: </Typography>\r\n            <Box className=\"receiver-container\" display=\"inline-block\" >\r\n                <SelectedUsers items={receivers} onCloseClick={onRemoveSelectedUser}></SelectedUsers>\r\n                <Box className=\"receiver-input-container\">\r\n                    {/* input */}\r\n                    <TextField placeholder=\"Receiver\" ref={inputRef} className=\"receiver-input\" autoFocus={true} onKeyUp={onInputKeyup} onChange={onInputChange} onBlur={onInputBlur} value={inputVal} />\r\n                    {/* LIST */}\r\n                    {(suggestionUsers.length > 0) ? (\r\n                        <SuggestionUsers items={suggestionUsers} onItemClick={onSuggestionUserClick}></SuggestionUsers>\r\n                    ) : null}\r\n                    {/* END LIST */}\r\n                </Box>\r\n            </Box>\r\n        </Box>\r\n    )\r\n}","import { Avatar, List, ListItem, ListItemAvatar, ListItemText } from '@material-ui/core'\r\nimport React from 'react'\r\nimport './SuggestionUsers.css'\r\n\r\nexport default function SuggestionUsers({ items = [], onItemClick }) {\r\n\r\n    function generateSuggestionUsers(items) {\r\n        return items.map((item) => {\r\n            return (\r\n                <ListItem button key={item._id} onClick={() => { onItemClick(item) }}>\r\n                    <ListItemAvatar>\r\n                        <Avatar src={item.picture}> </Avatar>\r\n                    </ListItemAvatar>\r\n                    <ListItemText\r\n                        primary={item.username}\r\n                        secondary={false ? 'Secondary text' : null}\r\n                    />\r\n                </ListItem>\r\n            )\r\n        })\r\n    }\r\n    return (\r\n        <List className=\"suggestion-receiver-list\" dense={false} >\r\n            {generateSuggestionUsers(items)}\r\n        </List>\r\n    )\r\n}\r\n","import { Box, Paper, Typography } from '@material-ui/core';\r\nimport React, { useEffect, useState } from 'react'\r\nimport { useDispatch } from 'react-redux';\r\nimport { resetNewChat, setNewChatEnabled } from '../../features/NewChat/NewChatSlice';\r\nimport NormalChat from '../NormalChat/NormalChat';\r\nimport Receiver from '../Receiver/Receiver';\r\n\r\nexport default function NewChat() {\r\n    const [friendId, setFriendId] = useState(null);\r\n    const dispatch = useDispatch();\r\n    const onFriendIdSelected = (id) => {\r\n        setFriendId(id);\r\n    }\r\n\r\n    useEffect(() => {\r\n        dispatch(setNewChatEnabled(true));\r\n        return () => {\r\n            dispatch(resetNewChat());\r\n        }\r\n    }, [])\r\n\r\n    return (\r\n        <Box position=\"relative\" height=\"100%\">\r\n            {/* INPUT */}\r\n            <Paper style={{ position: 'absolute', zIndex: '1000', width: '100%', boxShadow: 'none', padding: '16px' }}>\r\n                <Receiver onFriendIdSelected={onFriendIdSelected}></Receiver>\r\n            </Paper>\r\n\r\n            {/* CHAT AREA */}\r\n            <Box>\r\n                <NormalChat friendId={friendId} type=\"temp\"></NormalChat>\r\n            </Box>\r\n        </Box >\r\n    )\r\n}\r\n","import { Box, Divider } from '@material-ui/core';\r\nimport React, { useEffect, useState } from 'react'\r\nimport { useSelector } from 'react-redux';\r\nimport { useHistory, useParams } from 'react-router-dom';\r\nimport { conversationStatus } from '../../features/chat/ChatSlice';\r\nimport NewChat from '../NewChat/NewChat';\r\nimport NormalChat from '../NormalChat/NormalChat';\r\nimport SendMessageBar from '../SendMessageBar/SendMessageBar';\r\nimport UserTyping from '../UserTyping/UserTyping';\r\n\r\n\r\nexport default function ChatBox({ children }) {\r\n    const [loaded] = useState(true);\r\n    const params = useParams();\r\n    const history = useHistory();\r\n    const [display, setDisplay] = useState(null);\r\n    const convoStatus = useSelector(conversationStatus);\r\n\r\n    useEffect(() => {\r\n        const { type, conversationId } = params;\r\n        if (type) {\r\n            switch (type) {\r\n                case 't':\r\n                    if (!conversationId) history.replace('/chat');\r\n                    setDisplay('chat');\r\n                    break;\r\n                case 'new':\r\n                    if (conversationId) history.replace('/chat/new');\r\n                    setDisplay('new');\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        } else {\r\n            //home chat\r\n            setDisplay('chat');\r\n\r\n        }\r\n        return () => {\r\n        }\r\n    }, [params])\r\n\r\n    const mainHtml = (\r\n        <Box className=\"chat-box-wrapper\">\r\n            {\r\n                display === 'chat'\r\n                    ?\r\n                    <NormalChat></NormalChat>\r\n                    : <NewChat></NewChat>\r\n            }\r\n            <div style={{ position: 'absolute', bottom: '100px', left: '5px', width: '100%' }}>\r\n                <UserTyping></UserTyping>\r\n            </div>\r\n            <Box display={convoStatus === 'loading' ? 'none' : 'unset'}>\r\n                <SendMessageBar></SendMessageBar>\r\n            </Box>\r\n        </Box>\r\n    )\r\n\r\n    return (\r\n        <React.Fragment> { loaded ? mainHtml : children} </React.Fragment>\r\n    )\r\n}\r\n","import { Typography } from '@material-ui/core'\r\nimport React from 'react'\r\n\r\nexport default function AppTitle({ title }) {\r\n    return (\r\n        <Typography variant=\"h5\">{title}</Typography>\r\n    )\r\n}\r\n","import { createEntityAdapter, createSlice } from '@reduxjs/toolkit'\r\n\r\nconst adapter = createEntityAdapter({\r\n    selectId: item => item._id,\r\n})\r\n\r\nconst initialState = adapter.getInitialState({\r\n    status: 'idle',\r\n    error: null\r\n})\r\n\r\nconst OnlineUserSlice = createSlice({\r\n    name: 'onlineUser',\r\n    initialState,\r\n    reducers: {\r\n        addAll: (state, action) => {\r\n            adapter.addMany(state, action.payload);\r\n        },\r\n        removeOne: (state, action) => {\r\n            adapter.removeOne(state, action.payload._id);\r\n        },\r\n        addOne: (state, action) => {\r\n            adapter.addOne(state, action.payload);\r\n        },\r\n    },\r\n});\r\n\r\nexport const {\r\n    selectAll: selectAllOnlineUser,\r\n    selectById: selectOnlineUserById,\r\n    selectIds: selectOnlineUserIds\r\n    // Pass in a selector that returns the posts slice of state\r\n} = adapter.getSelectors(state => state.onlineUser)\r\n\r\nexport const {\r\n    addAll: addAllOnlineUser,\r\n    addOne: addOneOnlineUser,\r\n    removeOne: removeOneOnlineUser\r\n} = OnlineUserSlice.actions\r\nexport default OnlineUserSlice.reducer","import React, { useEffect, useState } from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport List from '@material-ui/core/List';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar';\r\nimport MyAvatar from '../MyAvatar/MyAvatar';\r\nimport Socket from '../../defines/Socket';\r\nimport MySocket from '../../defines/Socket/MySocket';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { authUser } from '../../features/auth/authSlice';\r\nimport { Box, Hidden, Typography } from '@material-ui/core';\r\nimport SocketEventName from '../../defines/Socket/SocketEventName';\r\nimport AppTitle from '../AppTitle/AppTitle';\r\nimport { conversationId, fetchConversationByUserIdsOrCreateIfNotExist, conversationMemberIds } from '../../features/chat/ChatSlice';\r\nimport ConversationApi from '../../defines/https/ConversationApi';\r\nimport { useHistory } from 'react-router-dom';\r\nimport Helper from '../../defines/Helper';\r\nimport ConversationLink from '../ConversationLink/ConversationLink';\r\nimport { selectAllOnlineUser } from '../../features/OnlineUser/OnlineUserSlice';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    root: {\r\n        width: '100%',\r\n    },\r\n}));\r\n\r\nexport default function OnlineUsers({ item }) {\r\n    const classes = useStyles();\r\n    const [isShow, setShow] = useState(false);\r\n    const user = useSelector(authUser) || {};\r\n    const onlineUsers = useSelector(selectAllOnlineUser);\r\n\r\n\r\n    useEffect(() => {\r\n        //console.log(onlineUsers);\r\n    }, [onlineUsers])\r\n\r\n    //useEffect(() => {\r\n    //setTimeout(() => {\r\n    //setShow(true);\r\n    //}, 500);\r\n    //}, [])\r\n\r\n    const onlineUsersHtml = onlineUsers.filter((item) => {\r\n        return (item.username !== user.username)\r\n    }).map((item) => {\r\n        return (\r\n            <ConversationLink key={item._id} button component={ListItem} item={item}>\r\n                <ListItemAvatar >\r\n                    <MyAvatar online={true} name={item.name} single={item.single} picture={item.picture}></MyAvatar>\r\n                </ListItemAvatar>\r\n                <Hidden smDown>\r\n                    <ListItemText\r\n                        primary={item.username}\r\n                    />\r\n                </Hidden>\r\n            </ConversationLink>\r\n        )\r\n    })\r\n\r\n    const emptyHtml = (\r\n        <Typography className=\"text-muted\" align=\"center\" >No online users</Typography>\r\n    )\r\n\r\n    return (\r\n        <Box className=\"online-users-wrapper\">\r\n            <Box p={2} className=\"title\">\r\n                <AppTitle title=\"Online\"></AppTitle>\r\n            </Box>\r\n            <List className={`${classes.root} online-users-list`}>\r\n                {/* \r\n                {\r\n                    isShow\r\n                        ? (onlineUsersHtml.length > 0 ? onlineUsersHtml : emptyHtml)\r\n                        : null\r\n                }\r\n                 */}\r\n                {onlineUsersHtml.length > 0 ? onlineUsersHtml : emptyHtml}\r\n            </List >\r\n        </Box>\r\n    );\r\n}","import React, { useState } from 'react'\r\nimport Grid from '@material-ui/core/Grid'\r\nimport { useEffect } from 'react'\r\nimport Slt from '../../defines/Slt'\r\nimport ConversationList from '../../components/ConversationList/ConversationList'\r\nimport ChatBox from '../../components/ChatBox/ChatBox'\r\nimport OnlineUsers from '../../components/OnlineUser/OnlineUsers'\r\nimport useStyles from '../../defines/styles/MainStyles'\r\nimport { Box, Hidden } from '@material-ui/core'\r\n\r\nexport default function Chat() {\r\n    const classes = useStyles();\r\n    const [appBarHeight,\r\n        setAppBarHeight] = useState(0);\r\n\r\n    // HANDLE HEIGHT\r\n    const heightStyle = {\r\n        height: `calc(100vh - ${appBarHeight}px)`\r\n    }\r\n\r\n    const handleAppBarResize = () => {\r\n        let height = document\r\n            .getElementById(Slt.mainAppBar)\r\n            .clientHeight;\r\n        setAppBarHeight(height);\r\n    }\r\n\r\n    // HANDLE APP BAR RESIZE\r\n    useEffect(() => {\r\n        //handleAppBarResize();\r\n        //window.addEventListener('resize', handleAppBarResize)\r\n    }, []);\r\n\r\n    // DISPLAY LATEST CONVERSATION\r\n\r\n    return (\r\n        <Box className=\"main-content\" p={2} >\r\n            <Grid style={{ height: '100%' }} container >\r\n                <Grid style={{ height: '100%', padding: 0 }} item xs={3} className={`${classes.borderRight500}`} >\r\n                    <ConversationList></ConversationList>\r\n                </Grid>\r\n                <Grid style={{ height: '100%' }} item xs={9} md={7}>\r\n                    <ChatBox>\r\n                        Loading...\r\n                    </ChatBox>\r\n                </Grid>\r\n                <Hidden smDown>\r\n                    <Grid style={{ height: '100%', padding: 0 }} item xs={false} md={2} className={`${classes.borderLeft500} `}>\r\n                        <OnlineUsers />\r\n                    </Grid>\r\n                </Hidden>\r\n            </Grid>\r\n        </Box>\r\n    )\r\n}\r\n","const FormErrors = {\r\n    required: '{0} required',\r\n    lengthGreater: '{0} must greater than {1} characters',\r\n    noSpecialCharacter: '{0} must not contain special characters',\r\n    unique: '{0} must be unique',\r\n    match: '{0} must match',\r\n}\r\nexport default FormErrors;","import React, { useState, } from 'react';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport Button from '@material-ui/core/Button';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport LockOutlinedIcon from '@material-ui/icons/LockOutlined';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Container from '@material-ui/core/Container';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { setNotify } from '../../features/notify/NotifySlice';\r\nimport { isLogged, loginThunk, status, authError } from '../../features/auth/authSlice';\r\nimport { useCookies } from 'react-cookie';\r\nimport Helper from '../../defines/Helper'\r\nimport { LOGGED_USER } from '../../defines/CookieName';\r\nimport Message from '../../defines/Message';\r\nimport { Formik } from 'formik';\r\nimport * as yup from 'yup';\r\nimport { Box } from '@material-ui/core';\r\nimport FormErrors from '../../defines/configs/FormErrors';\r\nimport RouterLink from '../RouterLink/RouterLink';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    paper: {\r\n        marginTop: theme.spacing(8),\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        alignItems: 'center'\r\n    },\r\n    avatar: {\r\n        margin: theme.spacing(1),\r\n        backgroundColor: theme.palette.secondary.main\r\n    },\r\n    form: {\r\n        width: '100%', // Fix IE 11 issue.\r\n        marginTop: theme.spacing(1)\r\n    },\r\n    submit: {\r\n        margin: theme.spacing(3, 0, 2)\r\n    }\r\n}));\r\n\r\nexport default function SignIn() {\r\n    const dispatch = useDispatch();\r\n    const [isSubmitClicked, setSubmitClicked] = useState(false);\r\n\r\n    // SELECTOR\r\n    const logged = useSelector(isLogged);\r\n    const [cookies, setCookie] = useCookies([LOGGED_USER]);\r\n\r\n    const authStatus = useSelector(status);\r\n    const authErr = useSelector(authError);\r\n\r\n    const classes = useStyles();\r\n    if (isSubmitClicked) {\r\n        if (authStatus === 'succeeded' && authErr)\r\n            dispatch(setNotify({ message: 'Login unsuccessfully', type: 'error', open: true }))\r\n    } else {\r\n        if (authStatus === 'loading') return null;\r\n    }\r\n\r\n    const mainHtml = (\r\n        <Container component=\"main\" maxWidth=\"xs\">\r\n            <CssBaseline />\r\n            <div className={classes.paper}>\r\n                <Avatar className={classes.avatar}>\r\n                    <LockOutlinedIcon />\r\n                </Avatar>\r\n                <Typography component=\"h1\" variant=\"h5\">\r\n                    Sign in\r\n                    </Typography>\r\n\r\n                {/* FORMIK */}\r\n                <Formik\r\n                    initialValues={{\r\n                        username: '',\r\n                        password: '',\r\n                        passwordConfirmation: ''\r\n                    }}\r\n                    validationSchema={yup.object({\r\n                        username: yup.string().required(Helper.format(FormErrors.required, 'Username')),\r\n                        password: yup.string().required(Helper.format(FormErrors.required, 'Password')),\r\n                    })}\r\n                    onSubmit={async (values, { setSubmitting }) => {\r\n                        const { username, password } = values;\r\n                        let user = {\r\n                            username,\r\n                            password\r\n                        };\r\n                        setSubmitClicked(true);\r\n                        dispatch(loginThunk(user));\r\n                        setCookie(LOGGED_USER, user);\r\n                        //alert(JSON.stringify(values));\r\n                    }}>\r\n                    {({\r\n                        values,\r\n                        errors,\r\n                        touched,\r\n                        handleChange,\r\n                        handleBlur,\r\n                        handleSubmit,\r\n                        isSubmitting,\r\n                        isValid,\r\n                        dirty,\r\n                        /* and other goodies */\r\n                    }) => {\r\n                        const showErrors = {};\r\n                        for (let key in errors) {\r\n                            showErrors[key] = (errors[key] != null) && touched[key];\r\n                        }\r\n                        const props = (field, label) => {\r\n                            label = label || Helper.ucFirst(field);\r\n                            return {\r\n                                fullWidth: true,\r\n                                margin: 'normal',\r\n                                placeholder: label,\r\n                                variant: 'outlined',\r\n                                name: field,\r\n                                onChange: handleChange,\r\n                                onBlur: handleBlur,\r\n                                value: values[label],\r\n                                label: label,\r\n                                error: (showErrors[field]),\r\n                                helperText: (showErrors[field])\r\n                                    ? errors[field]\r\n                                    : null\r\n                            }\r\n                        }\r\n                        return (\r\n                            <form onSubmit={handleSubmit} noValidate autoComplete=\"off\">\r\n                                <TextField autoFocus={true} type=\"text\" {...props('username')} />\r\n                                <TextField type=\"password\" {...props('password')} />\r\n                                <Box >\r\n                                    <Button\r\n                                        disabled={isSubmitting || !isValid || !dirty}\r\n                                        type=\"submit\"\r\n                                        fullWidth\r\n                                        variant=\"contained\"\r\n                                        color=\"primary\"\r\n                                    > Sign In\r\n                                    </Button>\r\n                                </Box>\r\n                                <RouterLink to=\"/sign-up\" >\r\n                                    <Typography color=\"primary\" style={{ cursor: 'pointer' }} >\r\n                                        Create an account\r\n                                    </Typography>\r\n                                </RouterLink>\r\n                            </form>\r\n                        )\r\n                    }}\r\n                </Formik>\r\n                {/* END FORMIK */}\r\n\r\n            </div>\r\n        </Container>\r\n    )\r\n\r\n    return (!logged ? mainHtml : (null));\r\n}\r\n","import * as yup from 'yup';\r\nimport FormErrors from '../configs/FormErrors';\r\nimport Helper from '../Helper';\r\nimport UserApi from '../https/UserApi';\r\n\r\nconst isUsernameExist = async username => {\r\n    if (username) {\r\n        const data = await UserApi.findByUsername(username);\r\n        return (data.status === 'succeeded');\r\n    }\r\n    return false;\r\n}\r\n\r\n// length\r\nconst isLengthValid = (value, length) => {\r\n    if (value) {\r\n        return (value.length >= length)\r\n    }\r\n    return false;\r\n}\r\n\r\n// contain special characters\r\nconst noSpecialCharacters = (value) => {\r\n    if (value) {\r\n        return (/^[a-zA-Z0-9]+$/.test(value));\r\n    }\r\n    return false;\r\n}\r\n\r\nconst UserValidates = {\r\n    username: function (username, setUsername, timeoutObj) {\r\n        const label = 'Username';\r\n        return yup\r\n            .string()\r\n            .required(Helper.format(FormErrors.required, label))\r\n            .test('length', Helper.format(FormErrors.lengthGreater, label, 4), (value, context) => {\r\n                return (isLengthValid(value, 4));\r\n            })\r\n            .test('specialCharacter', Helper.format(FormErrors.noSpecialCharacter, label), (value, context) => {\r\n                return (noSpecialCharacters(value));\r\n            })\r\n            .test('usernameExist', Helper.format(FormErrors.unique, label), async (value, context) => {\r\n                if (isLengthValid(value, 4) && noSpecialCharacters(value)) {\r\n                    if (value !== username.value) {\r\n                        clearTimeout(timeoutObj);\r\n                        if (!value) return true;\r\n                        return new Promise((resolve, reject) => {\r\n                            timeoutObj = setTimeout(async () => {\r\n                                const isExist = await isUsernameExist(value);\r\n                                setUsername({ value, unique: !isExist });\r\n                                resolve(!isExist);\r\n                            }, 500);\r\n                        });\r\n                    }\r\n                }\r\n                return username.unique;\r\n            });\r\n\r\n    },\r\n    password: function () {\r\n        const label = 'Password';\r\n        return yup\r\n            .string()\r\n            .required(Helper.format(FormErrors.required, label))\r\n            .matches(/[a-zA-Z0-9]{3,}/, Helper.format(FormErrors.lengthGreater, label));\r\n    },\r\n    passwordConfirmation: function () {\r\n        const label = 'Password confirmation';\r\n        return yup\r\n            .string()\r\n            .required(Helper.format(FormErrors.required, label))\r\n            .oneOf([yup.ref('password')], Helper.format(FormErrors.match, label));\r\n    }\r\n}\r\n\r\nexport default UserValidates;\r\n","import React, { useState, } from 'react';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport Button from '@material-ui/core/Button';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport LockOutlinedIcon from '@material-ui/icons/LockOutlined';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Container from '@material-ui/core/Container';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { setNotify } from '../../features/notify/NotifySlice';\r\nimport { isLogged, login, status } from '../../features/auth/authSlice';\r\nimport Helper from '../../defines/Helper'\r\nimport { Formik } from 'formik';\r\nimport UserApi from '../../defines/https/UserApi';\r\nimport * as yup from 'yup';\r\nimport UserValidates from '../../defines/validates/UserValidates';\r\nimport Message from '../../defines/Message';\r\nimport { Box } from '@material-ui/core';\r\nimport RouterLink from '../RouterLink/RouterLink';\r\n\r\nlet timeoutObj;\r\nconst useStyles = makeStyles((theme) => ({\r\n    paper: {\r\n        marginTop: theme.spacing(8),\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        alignItems: 'center'\r\n    },\r\n    avatar: {\r\n        margin: theme.spacing(1),\r\n        backgroundColor: theme.palette.secondary.main\r\n    },\r\n    form: {\r\n        width: '100%', // Fix IE 11 issue.\r\n        marginTop: theme.spacing(1)\r\n    },\r\n}));\r\n\r\nexport default function SignUp() {\r\n    const dispatch = useDispatch();\r\n    const [username, setUsername] = useState({ value: '', unique: false });\r\n\r\n    // SELECTOR\r\n    const logged = useSelector(isLogged);\r\n    const authStatus = useSelector(status);\r\n    const classes = useStyles();\r\n\r\n    if (authStatus === 'loading')\r\n        return null;\r\n\r\n    return (!logged\r\n        ? (\r\n            <Container component=\"main\" maxWidth=\"xs\">\r\n                <CssBaseline />\r\n                <div className={classes.paper}>\r\n                    <Avatar className={classes.avatar}>\r\n                        <LockOutlinedIcon />\r\n                    </Avatar>\r\n                    <Typography component=\"h1\" variant=\"h5\">Sign Up</Typography>\r\n                    <Formik\r\n                        initialValues={{\r\n                            username: '',\r\n                            password: '',\r\n                            passwordConfirmation: ''\r\n                        }}\r\n                        validationSchema={yup.object({\r\n                            username: UserValidates.username(username, setUsername, timeoutObj),\r\n                            password: UserValidates.password(),\r\n                            passwordConfirmation: UserValidates.passwordConfirmation(),\r\n                        })}\r\n                        onSubmit={async (values, { setSubmitting }) => {\r\n                            const { username, password } = values;\r\n                            let data = await UserApi.createAccount(username, password);\r\n                            if (data.status === 'succeeded') {\r\n                                const user = data.payload;\r\n                                dispatch(setNotify({ message: Helper.format(Message.welcomeNewAccount, user.username) }));\r\n                                dispatch(login(user));\r\n                            } else {\r\n                                setSubmitting(false);\r\n                            }\r\n                        }}>\r\n                        {({\r\n                            values,\r\n                            errors,\r\n                            touched,\r\n                            handleChange,\r\n                            handleBlur,\r\n                            handleSubmit,\r\n                            isSubmitting,\r\n                            isValid,\r\n                            dirty\r\n                            /* and other goodies */\r\n                        }) => {\r\n                            const showErrors = {};\r\n                            for (let key in errors) {\r\n                                showErrors[key] = (errors[key] != null) && touched[key];\r\n                            }\r\n                            const props = (field, label) => {\r\n                                label = label || Helper.ucFirst(field);\r\n                                return {\r\n                                    fullWidth: true,\r\n                                    margin: 'normal',\r\n                                    placeholder: label,\r\n                                    variant: 'outlined',\r\n                                    name: field,\r\n                                    onChange: handleChange,\r\n                                    onBlur: handleBlur,\r\n                                    value: values[label],\r\n                                    label: label,\r\n                                    error: (showErrors[field]),\r\n                                    helperText: (showErrors[field])\r\n                                        ? errors[field]\r\n                                        : null\r\n                                }\r\n                            }\r\n                            return (\r\n                                <form onSubmit={handleSubmit} noValidate autoComplete=\"off\">\r\n                                    <TextField type=\"text\" {...props('username')} />\r\n                                    <TextField type=\"password\" {...props('password')} />\r\n                                    <TextField type=\"password\" {...props('passwordConfirmation', 'Password confirmation')} />\r\n                                    <Box >\r\n                                        <Button\r\n                                            disabled={isSubmitting || !isValid || !dirty}\r\n                                            type=\"submit\"\r\n                                            fullWidth\r\n                                            variant=\"contained\"\r\n                                            color=\"primary\"\r\n                                        > Sign Up </Button>\r\n                                    </Box>\r\n                                    <RouterLink to=\"/signin\">\r\n                                        <Typography color=\"primary\" style={{ cursor: 'pointer' }}>\r\n                                            Have an account?\r\n                                        </Typography>\r\n                                    </RouterLink>\r\n                                </form>\r\n                            )\r\n                        }}\r\n                    </Formik>\r\n                </div>\r\n            </Container >\r\n        )\r\n        : (null));\r\n}\r\n","import React from 'react';\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\nimport MuiAlert from '@material-ui/lab/Alert';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { type, message, open, setNotify, timeout } from './NotifySlice';\r\n\r\nfunction Alert(props) {\r\n    return <MuiAlert elevation={6} variant=\"filled\" {...props} />;\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    root: {\r\n        width: '100%',\r\n        '& > * + *': {\r\n            marginTop: theme.spacing(2)\r\n        }\r\n    }\r\n}));\r\n\r\nexport default function Notify() {\r\n    const classes = useStyles();\r\n    const dispatch = useDispatch();\r\n    const isOpen = useSelector(open);\r\n    const msg = useSelector(message);\r\n    const msgType = useSelector(type);\r\n    const duration = useSelector(timeout);\r\n\r\n    const handleClose = (event, reason) => {\r\n        if (reason === 'clickaway') {\r\n            return;\r\n        }\r\n        dispatch(setNotify({ open: false }));\r\n    };\r\n\r\n    return (\r\n        <div className={classes.root}>\r\n            {(msg)\r\n                ? (\r\n\r\n                    <Snackbar\r\n                        open={isOpen}\r\n                        autoHideDuration={duration}\r\n                        onClose={handleClose}\r\n                        anchorOrigin={{\r\n                            horizontal: 'right',\r\n                            vertical: 'top'\r\n                        }}\r\n                        message={msg}>\r\n                        {(msgType !== '')\r\n                            ? (\r\n\r\n                                <Alert onClose={handleClose} severity={msgType}>\r\n                                    {msg}\r\n                                </Alert>\r\n                            )\r\n                            : null\r\n                        }\r\n                    </Snackbar>\r\n                )\r\n                : ''}\r\n        </div>\r\n    );\r\n}\r\n","import React from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport {\r\n    Route,\r\n    Redirect,\r\n} from \"react-router-dom\";\r\nimport { isLogged } from \"../../features/auth/authSlice\";\r\n\r\nexport default function PrivateRoute({ children, ...rest }) {\r\n    const logged = useSelector(isLogged);\r\n    return (\r\n        <Route\r\n            {...rest}\r\n            render={({ location }) => {\r\n                return logged ? (\r\n                    children\r\n                ) : (\r\n                        <Redirect\r\n                            to={{\r\n                                pathname: \"/login\",\r\n                                state: { from: location }\r\n                            }}\r\n                        />\r\n                    )\r\n            }\r\n            }\r\n        />\r\n    );\r\n}","import { createAsyncThunk, createEntityAdapter, createSlice } from '@reduxjs/toolkit'\r\nimport UserApi from '../../defines/https/UserApi';\r\n\r\n// THUNKS\r\nexport const fetchFriendsByIds = createAsyncThunk('friend/fetchFriends', async ({ type, ids }) => {\r\n    const response = await UserApi.findUsersByIds(ids);\r\n    return { type, response };\r\n})\r\n\r\nexport const fetchStrangersByUsername = createAsyncThunk('friend/fetchFriends', async ({ username }) => {\r\n    const response = await UserApi.findStrangerByUsername(username);\r\n    return { type: 'stranger', response };\r\n})\r\n\r\n// ENTITY ADAPTER\r\nconst adapter = createEntityAdapter({\r\n    selectId: item => item._id,\r\n})\r\n\r\n// INITIAL STATE\r\nconst itemsInitialState = adapter.getInitialState({\r\n    status: 'idle',\r\n    error: null\r\n})\r\n\r\nconst initialState = {\r\n    friend: itemsInitialState,\r\n    request: itemsInitialState,\r\n    sent_request: itemsInitialState,\r\n    stranger: itemsInitialState,\r\n}\r\n\r\n// SLICE\r\nconst FriendSlice = createSlice({\r\n    name: 'friend',\r\n    initialState,\r\n    reducers: {\r\n        // current user\r\n        onAddFriend: (state, action) => {\r\n            const { user } = action.payload;\r\n            adapter.removeOne(state.stranger, user._id);\r\n            adapter.addOne(state.sent_request, user);\r\n        },\r\n        onUnFriend: (state, action) => {\r\n            const { user } = action.payload;\r\n            adapter.removeOne(state.friend, user._id);\r\n            adapter.addOne(state.stranger, user);\r\n        },\r\n        onCancelFriendRequest: (state, action) => {\r\n            const { user } = action.payload;\r\n            adapter.removeOne(state.sent_request, user._id);\r\n            adapter.addOne(state.stranger, user);\r\n        },\r\n        onRejectFriendRequest: (state, action) => {\r\n            const { user } = action.payload;\r\n            adapter.removeOne(state.request, user._id);\r\n            adapter.addOne(state.stranger, user);\r\n        },\r\n        onAcceptFriendRequest: (state, action) => {\r\n            const { user } = action.payload;\r\n            adapter.removeOne(state.request, user._id);\r\n            adapter.addOne(state.friend, user);\r\n        },\r\n\r\n        // friend\r\n        onFriendRequested: (state, action) => {\r\n            const { user } = action.payload;\r\n            adapter.removeOne(state.stranger, user._id);\r\n            adapter.addOne(state.request, user);\r\n        },\r\n        onFriendAccepted: (state, action) => {\r\n            const { user } = action.payload;\r\n            adapter.removeOne(state.sent_request, user._id);\r\n            adapter.addOne(state.friend, user);\r\n        },\r\n        onFriendUnfriend: (state, action) => {\r\n            const { user } = action.payload;\r\n            adapter.removeOne(state.friend, user._id);\r\n            adapter.addOne(state.stranger, user);\r\n        },\r\n        onFriendCanceled: (state, action) => {\r\n            const { user } = action.payload;\r\n            adapter.removeOne(state.request, user._id);\r\n            adapter.addOne(state.stranger, user);\r\n        },\r\n        onFriendRejected: (state, action) => {\r\n            const { user } = action.payload;\r\n            adapter.removeOne(state.sent_request, user._id);\r\n            adapter.addOne(state.stranger, user);\r\n        },\r\n    },\r\n    extraReducers: {\r\n        // fetch friends\r\n        [fetchFriendsByIds.pending]: (state, action) => {\r\n            const { type } = action.meta.arg;\r\n            const currentState = state[type];\r\n            currentState.status = 'loading'\r\n        },\r\n        [fetchFriendsByIds.fulfilled]: (state, action) => {\r\n            const { type, response } = action.payload;\r\n            const { payload, status } = response;\r\n            const currentState = state[type];\r\n            if (status === 'succeeded') {\r\n                adapter.upsertMany(currentState, payload)\r\n                currentState.error = null;\r\n            } else currentState.error = 'not found';\r\n            currentState.status = 'succeeded'\r\n        },\r\n        [fetchFriendsByIds.rejected]: (state, action) => {\r\n        }\r\n    }\r\n});\r\n\r\n// SELECTORS\r\nconst selectors = {\r\n    friendStatus: (state, type) => {\r\n        return state.friend[type].status;\r\n    },\r\n    friendError: (state, type) => {\r\n        return state.friend[type].error;\r\n    }\r\n}\r\n\r\nexport const { friendStatus } = selectors;\r\n\r\nexport const {\r\n    selectAll: selectAllFriend,\r\n    selectById: selectFriendById,\r\n    selectIds: selectFriendIds\r\n    // Pass in a selector that returns the posts slice of state\r\n} = adapter.getSelectors(state => state.friend.friend)\r\n\r\nexport const {\r\n    selectAll: selectAllRequest,\r\n    selectById: selectRequestById,\r\n    selectIds: selectRequestIds\r\n    // Pass in a selector that returns the posts slice of state\r\n} = adapter.getSelectors(state => state.friend.request)\r\n\r\nexport const {\r\n    selectAll: selectAllSentRequest,\r\n    selectById: selectSentRequestById,\r\n    selectIds: selectSentRequestIds\r\n    // Pass in a selector that returns the posts slice of state\r\n} = adapter.getSelectors(state => state.friend.sent_request)\r\n\r\nexport const {\r\n    selectAll: selectAllStranger,\r\n    selectById: selectStrangerById,\r\n    selectIds: selectStrangerIds\r\n    // Pass in a selector that returns the posts slice of state\r\n} = adapter.getSelectors(state => state.friend.stranger)\r\n\r\nexport const {\r\n    onFriendRequested,\r\n    onFriendAccepted,\r\n    onFriendCanceled,\r\n    onFriendRejected,\r\n    onFriendUnfriend,\r\n    onAcceptFriendRequest,\r\n    onAddFriend,\r\n    onCancelFriendRequest,\r\n    onRejectFriendRequest,\r\n    onUnFriend\r\n} = FriendSlice.actions\r\nexport default FriendSlice.reducer","import { Button } from '@material-ui/core'\r\nimport React from 'react'\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport UserApi from '../../defines/https/UserApi';\r\nimport MySocket from '../../defines/Socket/MySocket';\r\nimport mainStyles from '../../defines/styles/MainStyles'\r\nimport { authUser } from '../../features/auth/authSlice';\r\nimport { onCancelFriendRequest } from '../../features/friend/FriendSlice';\r\n\r\nexport default function SentRequestAction({ item }) {\r\n    const dispatch = useDispatch();\r\n    const classes = mainStyles();\r\n    const user = useSelector(authUser);\r\n    const onCancelClick = async () => {\r\n        const data = await UserApi.cancelFriendRequest(user._id, item._id);\r\n        if (data.status === 'succeeded') {\r\n            MySocket.emitCancelFriendRequest(user, item._id);\r\n            dispatch(onCancelFriendRequest({ user: item }));\r\n        }\r\n    }\r\n    return (\r\n        <React.Fragment>\r\n            <Button onClick={onCancelClick} variant=\"contained\" size=\"small\" className={classes.buttonStyle}>Cancel request</Button>\r\n        </React.Fragment>\r\n    )\r\n}\r\n","import { Button } from '@material-ui/core'\r\nimport React from 'react'\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport UserApi from '../../defines/https/UserApi';\r\nimport Message from '../../defines/Message';\r\nimport MySocket from '../../defines/Socket/MySocket';\r\nimport mainStyles from '../../defines/styles/MainStyles'\r\nimport { authUser, updateUser } from '../../features/auth/authSlice';\r\nimport { onAcceptFriendRequest, onRejectFriendRequest } from '../../features/friend/FriendSlice';\r\n\r\nexport default function SentRequestAction({ item }) {\r\n    const dispatch = useDispatch();\r\n    const classes = mainStyles();\r\n    const user = useSelector(authUser);\r\n    const onConfirmClick = async () => {\r\n        const data = await UserApi.confirmFriendRequest(user._id, item._id);\r\n        if (data.status === 'succeeded') {\r\n            MySocket.emitAcceptFriend(user, item._id);\r\n            dispatch(onAcceptFriendRequest({ user: item }));\r\n        }\r\n    }\r\n\r\n    const onDeleteClick = async () => {\r\n        const data = await UserApi.deleteFriendRequest(user._id, item._id);\r\n        if (data.status === 'succeeded') {\r\n            MySocket.emitDeleteFriendRequest(user, item._id);\r\n            dispatch(onRejectFriendRequest({ user: item }));\r\n        }\r\n    }\r\n    return (\r\n        <React.Fragment>\r\n            <Button onClick={onConfirmClick} color=\"primary\" variant=\"contained\" size=\"small\" className={classes.buttonStyle}>Confirm</Button>\r\n            <Button onClick={onDeleteClick} variant=\"contained\" size=\"small\" className={classes.buttonStyle}>Delete</Button>\r\n        </React.Fragment>\r\n    )\r\n}\r\n","import { Button } from '@material-ui/core'\r\nimport React from 'react'\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport UserApi from '../../defines/https/UserApi';\r\nimport Message from '../../defines/Message';\r\nimport MySocket from '../../defines/Socket/MySocket';\r\nimport mainStyles from '../../defines/styles/MainStyles'\r\nimport { authUser, updateUser } from '../../features/auth/authSlice';\r\nimport { onAddFriend } from '../../features/friend/FriendSlice';\r\n\r\nexport default function SentRequestAction({ item }) {\r\n    const classes = mainStyles();\r\n    const user = useSelector(authUser);\r\n    const dispatch = useDispatch();\r\n    const onAddFriendClick = async () => {\r\n        const data = await UserApi.sentFriendRequest(user._id, item._id);\r\n        if (data.status === 'succeeded') {\r\n            //MySocket.emitUpdateUserById(user._id);\r\n            MySocket.emitAddFriend(user, item._id);\r\n            dispatch(onAddFriend({user: item}));\r\n        }\r\n    }\r\n    return (\r\n        <React.Fragment>\r\n            <Button onClick={onAddFriendClick} color=\"primary\" variant=\"contained\" size=\"small\" className={classes.buttonStyle}>Add friend</Button>\r\n        </React.Fragment>\r\n    )\r\n}\r\n","import React, { useState } from 'react';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\r\nimport { Button } from '@material-ui/core';\r\nimport mainStyles from '../../defines/styles/MainStyles'\r\nimport UserApi from '../../defines/https/UserApi';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { authUser } from '../../features/auth/authSlice';\r\nimport MySocket from '../../defines/Socket/MySocket';\r\nimport ConversationLink from '../ConversationLink/ConversationLink';\r\nimport { onUnFriend } from '../../features/friend/FriendSlice';\r\n\r\nconst ITEM_HEIGHT = 48;\r\n\r\nexport default function SentRequestAction({ item }) {\r\n\r\n    const dispatch = useDispatch();\r\n    const user = useSelector(authUser);\r\n    const classes = mainStyles();\r\n    const [anchorEl, setAnchorEl] = useState(null);\r\n    const open = Boolean(anchorEl);\r\n\r\n    const handleClick = (event) => {\r\n        setAnchorEl(event.currentTarget);\r\n    };\r\n\r\n    const handleClose = () => {\r\n        setAnchorEl(null);\r\n    };\r\n\r\n    // click\r\n    const onUnfriendClick = async () => {\r\n        const data = await UserApi.unfriend(user._id, item._id);\r\n        if (data.status === 'succeeded') {\r\n            MySocket.emitUnfriend(user, item._id);\r\n            dispatch(onUnFriend({ user: item }));\r\n        }\r\n        setAnchorEl(null);\r\n    }\r\n\r\n    const onChat = () => {\r\n        setAnchorEl(null);\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <IconButton\r\n                aria-label=\"more\"\r\n                aria-controls=\"long-menu\"\r\n                aria-haspopup=\"true\"\r\n                onClick={handleClick}\r\n            >\r\n                <MoreVertIcon />\r\n            </IconButton>\r\n            <Menu\r\n                id=\"long-menu\"\r\n                anchorEl={anchorEl}\r\n                keepMounted\r\n                open={open}\r\n                onClose={handleClose}\r\n                PaperProps={{\r\n                    style: {\r\n                        maxHeight: ITEM_HEIGHT * 4.5,\r\n                        width: '20ch',\r\n                    },\r\n                }}\r\n            >\r\n                <MenuItem>\r\n                    <ConversationLink item={item} style={{ width: '100%' }}>\r\n                        <Button onClick={onChat} variant=\"contained\" size=\"small\" fullWidth color=\"primary\" className={classes.buttonStyle}>Chat</Button>\r\n                    </ConversationLink>\r\n                </MenuItem>\r\n                <MenuItem><Button onClick={onUnfriendClick} variant=\"contained\" size=\"small\" fullWidth className={classes.buttonStyle}>Unfriend</Button></MenuItem>\r\n            </Menu>\r\n        </div>\r\n    );\r\n}\r\n","import {\r\n    Card,\r\n    CardActions,\r\n    CardHeader,\r\n    Grid,\r\n    Typography\r\n} from '@material-ui/core'\r\nimport React from 'react'\r\nimport { authUser } from '../../features/auth/authSlice';\r\nimport MyAvatar from '../MyAvatar/MyAvatar'\r\nimport SentRequestAction from '../FriendAction/SentRequestAction';\r\nimport RequestAction from '../FriendAction/RequestAction';\r\nimport StrangerAction from '../FriendAction/StrangerAction';\r\nimport FriendAction from '../FriendAction/FriendAction';\r\nimport { useSelector } from 'react-redux';\r\nimport Loading from '../Loading/Loading';\r\nconst getType = (user, friendId) => {\r\n    let { friend, request, sent_request } = user.friend;\r\n\r\n    let type;\r\n    if (friend.indexOf(friendId) > -1) {\r\n        type = 'friend';\r\n    } else if (request.indexOf(friendId) > -1) {\r\n        type = 'request';\r\n    } else if (sent_request.indexOf(friendId) > -1) {\r\n        type = 'sent_request';\r\n    } else type = 'stranger';\r\n\r\n    return type\r\n}\r\n\r\nexport default function FriendList({ items, type, isLoading }) {\r\n    const user = useSelector(authUser);\r\n    const itemsHtml = items.map((item, index) => {\r\n        let localType = type;\r\n        let action;\r\n        localType = type || getType(user, item._id);\r\n        if (localType === 'friend') {\r\n            action = <FriendAction item={item}></FriendAction>\r\n        } else if (localType === 'sent_request') {\r\n            action = <SentRequestAction item={item}></SentRequestAction>\r\n        } else if (localType === 'request') {\r\n            action = <RequestAction item={item}></RequestAction>\r\n        } else {\r\n            action = <StrangerAction item={item}></StrangerAction>\r\n        }\r\n        const actions = (\r\n            <CardActions style={{ justifyContent: 'flex-end' }}> {action} </CardActions>\r\n        )\r\n        return (\r\n            <Grid key={index} item xs={12} md={6} lg={4} >\r\n                <Card >\r\n                    <CardHeader\r\n                        avatar={< MyAvatar name={\r\n                            item.username\r\n                        }\r\n                            picture={\r\n                                item.picture\r\n                            } > </MyAvatar>}\r\n                        action={actions}\r\n                        title={item.username}\r\n                        subheader={null} />\r\n                </Card>\r\n            </Grid>\r\n        )\r\n    })\r\n\r\n    const message = (\r\n        <React.Fragment>\r\n            <Grid item xs={12}>\r\n                {isLoading\r\n                    ? <Loading></Loading>\r\n                    : <Typography align=\"center\" className=\"text-muted\">Your list is empty</Typography>\r\n                }\r\n            </Grid>\r\n        </React.Fragment>\r\n    )\r\n    return (\r\n        <React.Fragment>{itemsHtml.length > 0 ? itemsHtml : message}</React.Fragment>\r\n    );\r\n}","import {\r\n    Card,\r\n    CardHeader,\r\n    Grid,\r\n    IconButton,\r\n} from '@material-ui/core'\r\nimport React, { useEffect, useState } from 'react'\r\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\r\nimport UserApi from '../../defines/https/UserApi';\r\nimport { isLogged, authUser } from '../../features/auth/authSlice';\r\nimport MyAvatar from '../MyAvatar/MyAvatar'\r\nimport FriendList from '../FriendList/FriendList';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { fetchFriendsByIds, selectAllStranger, fetchStrangersByUsername, friendStatus, selectAllFriend, selectAllRequest, selectAllSentRequest } from '../../features/friend/FriendSlice';\r\n\r\nconst AllFriendList = () => {\r\n    const type = 'friend';\r\n    const items = useSelector(selectAllFriend);\r\n\r\n    const user = useSelector(authUser);\r\n    const status = useSelector((state) => friendStatus(state, type));\r\n    const dispatch = useDispatch();\r\n\r\n    useEffect(() => {\r\n        if (status === 'idle') {\r\n            dispatch(fetchFriendsByIds({ type, ids: user.friend[type] }));\r\n        }\r\n    }, [status, user.friend[type]])\r\n\r\n    return (\r\n        <FriendList items={items} type={type} isLoading={status === 'loading'}></FriendList>\r\n    );\r\n}\r\n\r\nconst SentRequestList = () => {\r\n    const type = 'sent_request';\r\n    const items = useSelector(selectAllSentRequest);\r\n\r\n    const user = useSelector(authUser);\r\n    const status = useSelector((state) => friendStatus(state, type));\r\n    const dispatch = useDispatch();\r\n\r\n    // FETCH\r\n    useEffect(() => {\r\n        if (status === 'idle') {\r\n            dispatch(fetchFriendsByIds({ type, ids: user.friend[type] }));\r\n        }\r\n    }, [status, user.friend[type]])\r\n\r\n    return (\r\n        <FriendList items={items} type={type} isLoading={status === 'loading'}></FriendList>\r\n    )\r\n}\r\n\r\nconst RequestList = () => {\r\n    const type = 'request';\r\n    const items = useSelector(selectAllRequest);\r\n\r\n    const user = useSelector(authUser);\r\n    const status = useSelector((state) => friendStatus(state, type));\r\n    const dispatch = useDispatch();\r\n\r\n    // FETCH\r\n    useEffect(() => {\r\n        if (status === 'idle') {\r\n            dispatch(fetchFriendsByIds({ type, ids: user.friend[type] }));\r\n        }\r\n    }, [status, user.friend[type]])\r\n\r\n    return (\r\n        <FriendList items={items} type={type} isLoading={status === 'loading'}></FriendList>\r\n    )\r\n}\r\n\r\nconst PeopleMayKnowList = ({ username }) => {\r\n    const type = 'stranger';\r\n    const items = useSelector(selectAllStranger);\r\n\r\n    const user = useSelector(authUser);\r\n    const status = useSelector((state) => friendStatus(state, type));\r\n    const dispatch = useDispatch();\r\n\r\n    // FETCH\r\n    useEffect(() => {\r\n        if (status === 'idle') {\r\n            dispatch(fetchStrangersByUsername({ type, username }));\r\n        }\r\n    }, [status, user.username])\r\n\r\n    return (\r\n        <FriendList items={items} type={type} isLoading={status === 'loading'}></FriendList>\r\n    )\r\n}\r\n\r\nexport default function FriendBox({ type }) {\r\n    let itemsHtml = null;\r\n    const logged = useSelector(isLogged);\r\n    const user = useSelector(authUser);\r\n    if (logged) {\r\n        switch (type) {\r\n            case 'friends_request':\r\n                itemsHtml = <RequestList username={user.username}></RequestList>\r\n                break;\r\n            case 'friends_sent_request':\r\n                itemsHtml = <SentRequestList username={user.username}></SentRequestList>\r\n                break;\r\n            case 'people_may_know':\r\n                itemsHtml = <PeopleMayKnowList username={user.username}></PeopleMayKnowList>\r\n                break;\r\n            default:\r\n                itemsHtml = <AllFriendList username={user.username}></AllFriendList>\r\n                break;\r\n        }\r\n    }\r\n\r\n    return (\r\n        <Grid style={{\r\n            paddingTop: '8px',\r\n        }} container spacing={2} >{itemsHtml}</Grid>\r\n    )\r\n}\r\n","import React, { useEffect } from 'react';\r\nimport './Friends.css';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Tabs from '@material-ui/core/Tabs';\r\nimport Tab from '@material-ui/core/Tab';\r\nimport Grid from '@material-ui/core/Grid'\r\nimport AppTitle from '../AppTitle/AppTitle';\r\nimport { useHistory, useParams } from 'react-router-dom';\r\nimport FriendBox from '../FriendBox/FriendBox';\r\nimport OnlineUsers from '../OnlineUser/OnlineUsers';\r\nimport mainStyles from '../../defines/styles/MainStyles';\r\nimport { Box } from '@material-ui/core';\r\n\r\n\r\nfunction a11yProps(index) {\r\n    return { id: `simple-tab-${index}`, 'aria-controls': `simple-tabpanel-${index}` };\r\n}\r\n\r\nconst friendTabs = ['friends_all', 'friends_request', 'friends_sent_request', 'people_may_know'];\r\n\r\nexport default function Friends() {\r\n    useEffect(() => {\r\n        const [body] = document.getElementsByTagName('body');\r\n        body.style.overflowY = 'scroll';\r\n        return () => {\r\n            body.style.overflowY = 'hidden';\r\n        }\r\n    }, [])\r\n\r\n    const classes = mainStyles();\r\n    const [value,\r\n        setValue] = React.useState(0);\r\n    const history = useHistory();\r\n    const params = useParams();\r\n\r\n    useEffect(() => {\r\n        let tab = params.friendsTab;\r\n        let index = friendTabs.indexOf(tab);\r\n        index = index < 0 ? 0 : index;\r\n        setValue(index);\r\n    }, [params.friendsTab])\r\n\r\n    const handleChange = (event, newValue) => {\r\n        setValue(newValue);\r\n        let tab = friendTabs[newValue];\r\n        history.push(`/${tab}`);\r\n    };\r\n\r\n    return (\r\n        <Box p={2} style={{ height: '100%' }}>\r\n            <Grid style={{ height: '100%' }} container spacing={2}>\r\n                <Grid style={{ height: '100%' }} item xs={9} >\r\n                    <AppTitle title=\"Friends\"></AppTitle>\r\n                    <Box mt={1} >\r\n                        <AppBar position=\"static\" color=\"default\">\r\n                            <Tabs value={value} onChange={handleChange} aria-label=\"simple tabs example\" indicatorColor=\"primary\" className=\"my-tabs\" scrollButtons=\"auto\" variant=\"scrollable\">\r\n                                <Tab label=\"All Friends\" {...a11yProps(0)} />\r\n                                <Tab label=\"Friend Requests\" {...a11yProps(1)} />\r\n                                <Tab label=\"Sent Requests\" {...a11yProps(2)} />\r\n                                <Tab label=\"People you may know\" {...a11yProps(3)} />\r\n                            </Tabs>\r\n                        </AppBar>\r\n                        <FriendBox type={friendTabs[value]}></FriendBox>\r\n                    </Box>\r\n                </Grid>\r\n                <Grid style={{ height: '100%' }} item xs={3} ><OnlineUsers /> </Grid>\r\n            </Grid>\r\n        </Box>\r\n    );\r\n}\r\n","import React, { useEffect } from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport {\r\n    Route,\r\n    useHistory,\r\n    useLocation,\r\n} from \"react-router-dom\";\r\nimport { isLogged } from \"../../features/auth/authSlice\";\r\n\r\nexport default function AuthRoute({ ...rest }) {\r\n    const logged = useSelector(isLogged);\r\n    const location = useLocation();\r\n    const history = useHistory();\r\n    useEffect(() => {\r\n        if (logged) {\r\n            let { from } = location.state || { from: { pathname: \"/\" } };\r\n            history.replace(from);\r\n        }\r\n    }, [logged, location.state, history])\r\n    return (\r\n        <Route {...rest}></Route>\r\n    );\r\n}","import React, { useEffect } from 'react';\r\nimport Grid from '@material-ui/core/Grid'\r\nimport Header from './components/Header/Header'\r\nimport Chat from './features/chat/Chat'\r\nimport { BrowserRouter as Router, Switch, Redirect, HashRouter } from 'react-router-dom'\r\nimport SignIn from './components/SignIn/SignIn'\r\nimport SignUp from './components/SignUp/SignUp'\r\nimport Notify from './features/notify/Notify'\r\nimport PrivateRoute from './components/PrivateRoute/PrivateRoute'\r\nimport { useCookies } from 'react-cookie'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { authUser, isLogged, loginThunk, updateUser } from './features/auth/authSlice'\r\nimport { conversationId } from './features/chat/ChatSlice'\r\nimport { LOGGED_USER } from './defines/CookieName';\r\nimport { Box, Paper } from '@material-ui/core';\r\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core/styles';\r\nimport Friends from './components/Friends/Friends';\r\nimport AuthRoute from './components/AuthRoute/AuthRoute';\r\nimport MySocket from './defines/Socket/MySocket';\r\nimport SocketEventName from './defines/Socket/SocketEventName';\r\nimport { setNotify } from './features/notify/NotifySlice';\r\nimport { onFriendUnfriend, onFriendRejected, onFriendCanceled, onFriendAccepted, onFriendRequested } from './features/friend/FriendSlice';\r\nimport Helper from './defines/Helper';\r\nimport Message from './defines/Message';\r\nimport { addAllOnlineUser, addOneOnlineUser, removeOneOnlineUser } from './features/OnlineUser/OnlineUserSlice';\r\n\r\n\r\nexport default function App() {\r\n    const [cookies] = useCookies([LOGGED_USER]);\r\n    const user = useSelector(authUser) || {};\r\n    const logged = useSelector(isLogged);\r\n    const convoId = useSelector(conversationId);\r\n    const dispatch = useDispatch();\r\n\r\n    useEffect(() => {\r\n        if (logged) {\r\n            MySocket.emitGetOnlineUsers();\r\n        }\r\n    }, [logged]);\r\n\r\n    useEffect(() => {\r\n        MySocket.onOnlineUsers((items) => {\r\n            dispatch(addAllOnlineUser(items));\r\n        });\r\n        MySocket.onNewOnlineUser((item) => {\r\n            dispatch(addOneOnlineUser(item));\r\n        })\r\n        MySocket.onOnlineUserLeft((item) => {\r\n            dispatch(removeOneOnlineUser(item));\r\n        })\r\n\r\n        // FRIENDS\r\n        const setupFriendEvents = () => {\r\n            MySocket.onFriendAccepted((data) => {\r\n                dispatch(setNotify({ message: Helper.format(Message.friendAccepted, data.user.username,), type: 'info', open: true }));\r\n                dispatch(onFriendAccepted({ user: data.user }))\r\n            })\r\n            MySocket.onFriendRequested((data) => {\r\n                dispatch(setNotify({ message: Helper.format(Message.friendRequested, data.user.username,), type: 'info', open: true }));\r\n                dispatch(onFriendRequested({ user: data.user }))\r\n            })\r\n            MySocket.onFriendUnFriend((data) => {\r\n                dispatch(onFriendUnfriend({ user: data.user }))\r\n            })\r\n            MySocket.onFriendRequestCanceled((data) => {\r\n                dispatch(onFriendCanceled({ user: data.user }))\r\n            })\r\n            MySocket.onFriendRejected((data) => {\r\n                dispatch(onFriendRejected({ user: data.user }))\r\n            })\r\n        }\r\n        setupFriendEvents();\r\n        return () => {\r\n            MySocket.off(SocketEventName.onlineUserLeft)\r\n            MySocket.off(SocketEventName.newOnlineUser)\r\n            MySocket.off(SocketEventName.onlineUsers)\r\n\r\n            // FRIENDS\r\n            MySocket.off(SocketEventName.friendAccepted)\r\n            MySocket.off(SocketEventName.friendRequested)\r\n            MySocket.off(SocketEventName.friendUnfriend)\r\n            MySocket.off(SocketEventName.friendRequestCanceled)\r\n            MySocket.off(SocketEventName.friendRejected)\r\n        }\r\n    }, [])\r\n\r\n\r\n    useEffect(() => {\r\n        MySocket.onUpdateUser((data) => {\r\n            dispatch(updateUser(data))\r\n        })\r\n\r\n        MySocket.onNewMessageNotification((data) => {\r\n            const { message, conversationId } = data;\r\n            if (conversationId !== convoId && message.from._id !== user._id) {\r\n                dispatch(setNotify({ message: Helper.format(Message.newMessage, message.from.username, message.text), type: 'success', open: true, timeout: 2000 }));\r\n            }\r\n        })\r\n        return () => {\r\n            MySocket.off(SocketEventName.updateUser)\r\n            MySocket.off(SocketEventName.newMessageNotification)\r\n        }\r\n    }, [user._id, convoId])\r\n\r\n    // SIGN IN WITH COOKIE\r\n    useEffect(() => {\r\n        if (cookies[LOGGED_USER])\r\n            dispatch(loginThunk(cookies[LOGGED_USER]))\r\n    }, [])\r\n\r\n    const themeType = useSelector((state) => {\r\n        return state.theme.type\r\n    });\r\n\r\n    const theme = createMuiTheme({\r\n        palette: {\r\n            type: themeType\r\n        }\r\n    });\r\n    return (\r\n        <ThemeProvider theme={theme}>\r\n            <HashRouter base=\"/\">\r\n                <Paper style={{ boxShadow: 'none' }}>\r\n                    <Box className=\"wrapper\">\r\n                        {/* HEADER */}\r\n                        <Header></Header>\r\n                        <Switch>\r\n                            {/* CONTENT */}\r\n                            <PrivateRoute path=\"/chat/:type(t|new)/:conversationId?\" exact> <Chat></Chat> </PrivateRoute>\r\n                            <PrivateRoute path={`/:friendsTab(friends|friends_all|friends_request|friends_sent_request|people_may_know)`} ><Friends></Friends> </PrivateRoute>\r\n                            <AuthRoute path=\"/login\" exact component={SignIn}></AuthRoute>\r\n                            <AuthRoute path=\"/sign-up\" exact component={SignUp}></AuthRoute>\r\n                            <Redirect to=\"/chat/new\"></Redirect>\r\n                        </Switch>\r\n                        <Notify></Notify>\r\n                    </Box>\r\n                </Paper>\r\n            </HashRouter>\r\n        </ThemeProvider >\r\n    )\r\n}\r\n","import { configureStore } from '@reduxjs/toolkit'\r\nimport authSlice from '../features/auth/authSlice'\r\nimport ChatSlice from '../features/chat/ChatSlice'\r\nimport FriendSlice from '../features/friend/FriendSlice'\r\nimport NewChatSlice from '../features/NewChat/NewChatSlice'\r\nimport NotifySlice from '../features/notify/NotifySlice'\r\nimport OnlineUserSlice from '../features/OnlineUser/OnlineUserSlice'\r\nimport SidebarConversationsSlice from '../features/sidebarConversations/SidebarConversationsSlice'\r\nimport themeSlice from '../GeneralSlices/themeSlice'\r\n\r\nexport default configureStore({\r\n    reducer: {\r\n        chat: ChatSlice,\r\n        notify: NotifySlice,\r\n        auth: authSlice,\r\n        sidebarConversations: SidebarConversationsSlice,\r\n        newChat: NewChatSlice,\r\n        friend: FriendSlice,\r\n        theme: themeSlice,\r\n        onlineUser: OnlineUserSlice\r\n    }\r\n})","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport { Provider } from 'react-redux';\nimport store from './components/store';\n\nReactDOM.render(\n    <Provider store={store}> <App></App> </Provider>\n    ,\n    document.getElementById('root')\n);\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals"],"sourceRoot":""}